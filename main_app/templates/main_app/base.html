{% load static %}
{% load ottm %}
{% load wpy_tags %}
<!DOCTYPE html>
<html lang="{{ context.lang.code }}" dir="{{ context.lang.writing_direction }}">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  {% if context.noindex %}
    <meta name="robots" content="noindex"/>
  {% endif %}

  <title>{% if context.tab_title %}{{ context.tab_title }} &mdash; {% endif %}{{ context.site_name }}</title>

  <link rel="stylesheet" href="//cdn.materialdesignicons.com/5.4.55/css/materialdesignicons.min.css"/>
  <link href="{% static 'main_app/bootstrap-4.5.2-dist/css/bootstrap.min.css' %}" rel="stylesheet"/>
  <link href="{% static 'main_app/style.css' %}" rel="stylesheet"/>
</head>
<body>
  <nav id="navbar" class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a id="nav-main-link" class="navbar-brand" href="{% url 'main_app:map' %}">{{ context.site_name }}</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item"
            {% if not context.user.is_logged_in %}title="{% ottm_translate 'navbar.edit.signup_title' %}"{% endif %}>
          <a id="nav-edit-link" class="nav-link{% if not context.user.is_logged_in %} disabled{% endif %}"
             href="{% url 'main_app:edit' %}" {% if not context.user.is_logged_in %}tabindex="-1"
             aria-disabled="true" {% endif %}><span class="mdi mdi-pencil"></span>
            {% ottm_translate 'navbar.edit.label' %}</a>
        </li>
        <li class="nav-item">
          <a id="nav-history-link" class="nav-link"
             href="{% url 'main_app:history' %}"><span class="mdi mdi-history"></span>
            {% ottm_translate 'navbar.history.label' %}</a>
        </li>
      </ul>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a id="nav-help-link" class="nav-link" href="{% url 'main_app:help' %}">
            <span class="mdi mdi-help-circle-outline"></span>
            {% ottm_translate 'navbar.help.label' %}</a>
        </li>
        <li class="nav-item">
          <a id="nav-about-link" class="nav-link" href="{% url 'main_app:about' %}">
            <span class="mdi mdi-information-outline"></span>
            {% ottm_translate 'navbar.about.label' %}</a>
        </li>
        <li class="nav-item">
          <a id="nav-copyright-link" class="nav-link"
             href="{% url 'main_app:copyright' %}"><span class="mdi mdi-copyright"></span>
            {% ottm_translate 'navbar.copyright.label' %}</a>
        </li>
        {% if context.user.is_logged_in %}
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
               aria-haspopup="true" aria-expanded="false">
              <span class="mdi mdi-account"></span> {{ context.user.username }}
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="{% url 'main_app:user_profile' username=context.user.username %}">
                <span class="mdi mdi-account"></span> Profile
              </a>
              <a class="dropdown-item" href="{% url 'main_app:user_contributions' username=context.user.username %}">
                <span class="mdi mdi-puzzle"></span> Contributions
              </a>
              <a class="dropdown-item" href="{% url 'main_app:user_settings' %}">
                <span class="mdi mdi-cog"></span> Settings
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" id="nav-logout-link" href="{% url 'main_app:log_out' %}">
                <span class="mdi mdi-logout"></span> {% ottm_translate 'navbar.log_out.label' %}
              </a>
            </div>
          </li>
        {% else %}
          <li class="nav-item">
            <a id="nav-login-link" class="nav-link"
               href="{% url 'wikipy:page' raw_page_title='Login'|wpy_page_title:-1|wpy_encode_url %}">
              <span class="mdi mdi-login"></span> {% ottm_translate 'navbar.log_in.label' %}
            </a>
          </li>
          <li class="nav-item">
            {% url 'main_app:log_in' as log_in_url %}
            <a id="nav-signup-link" class="nav-link"
               href="{% url 'wikipy:page' raw_page_title='Create account'|wpy_page_title:-1|wpy_encode_url %}">
              <span class="mdi mdi-account-plus"></span> {% ottm_translate 'navbar.sign_up.label' %}
            </a>
          </li>
        {% endif %}
      </ul>
    </div>
  </nav>

  {% block page-content %}{% endblock %}

  <script src="{% static 'main_app/jquery-3.5.1.min.js' %}"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
          integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
          crossorigin="anonymous"></script>
  <script src="{% static 'main_app/bootstrap-4.5.2-dist/js/bootstrap.min.js' %}"></script>
  <script src="{% static 'main_app/main.js' %}"></script>
  {% block page-scripts %}{% endblock %}
  <script>ottm.setReferer();</script>
</body>
</html>
