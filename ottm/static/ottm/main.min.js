"use strict";(function(){class Mapping{#mappings;constructor(data){this.#mappings=data;}
get(key){return this.#mappings[key];}
containsKey(key){return this.get(key)!==undefined;}
keys(){return Object.keys(this.#mappings);}
values(){return Object.values(this.#mappings);}
entries(){return Object.entries(this.#mappings);}
[Symbol.iterator](){const keys=this.keys();let i=-1;return{next:()=>({value:keys[++i],done:!(i in keys)}),};}}
class Language{#code;#name;#comma;#and;#writingDirection;#dayNames;#abbrDayNames;#monthNames;#abbrMonthNames;#ampm;#decimalSep;#thousandsSep;constructor(code,name,writingDirection,comma,and,dayNames,abbrDayNames,monthNames,abbrMonthNames,ampm,decimalSep,thousandsSep){if(dayNames.length!==7){throw new Error("dayNames expected 7 values");}
if(abbrDayNames.length!==7){throw new Error("abbrDayNames expected 7 values");}
if(monthNames.length!==12){throw new Error("monthNames expected 12 values");}
if(abbrMonthNames.length!==12){throw new Error("abbrMonthNames expected 12 values");}
if(ampm.length!==2){throw new Error("ampm expected 2 values");}
this.#code=code;this.#name=name;this.#writingDirection=writingDirection;this.#comma=comma;this.#and=and;this.#dayNames=dayNames;this.#abbrDayNames=abbrDayNames;this.#monthNames=monthNames;this.#abbrMonthNames=abbrMonthNames;this.#ampm=ampm;this.#decimalSep=decimalSep;this.#thousandsSep=thousandsSep;}
get code(){return this.#code;}
get name(){return this.#name;}
get writingDirection(){return this.#writingDirection;}
get comma(){return this.#comma;}
get and(){return this.#and;}
get dayNames(){return this.#dayNames;}
get abbrDayNames(){return this.#abbrDayNames;}
get monthNames(){return this.#monthNames;}
get abbrMonthNames(){return this.#abbrMonthNames;}
get ampm(){return this.#ampm;}
get decimalSep(){return this.#decimalSep;}
get thousandsSep(){return this.#thousandsSep;}
formatNumber(n){const s=n.toString();const decPart=s.includes(".")?s.split(".")[1]:"";const intPart=Math.floor(n).toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.thousandsSep);return intPart+(decPart?this.decimalSep+decPart:"");}
listToText(values){if(values.length===0){return'';}
if(values.length===1){return values[0];}
let list=values.slice(0,values.length-1).join(this.comma);return`${list}${this.and}${values[values.length - 1]}`;}}
window.ottm={config:new Mapping(window.OTTM_CONFIG.config),page:new Mapping(window.OTTM_CONFIG.page),user:new Mapping(window.OTTM_CONFIG.user),_translations:new Mapping(window.OTTM_CONFIG.translations),languages:[],Mapping:Mapping,Language:Language,convertDateTimezone:function(date,timezone){return new Date(date.toLocaleString("en-US",{timeZone:timezone}));},formatTime:function(date){const hours=date.getHours().toLocaleString("en-US",{minimumIntegerDigits:2});const minutes=date.getMinutes().toLocaleString("en-US",{minimumIntegerDigits:2});return`${hours}:${minutes}`;},setAccessKeys:function(){$("*[accesskey]").each((_,element)=>{const $element=$(element);const accessKey=$element.attr("accesskey");if(accessKey){const title=$element.attr("title");const shortcut=`[Alt+Shift+${accessKey}]`;$element.attr("title",(title?title+" ":"")+shortcut);}});},setReferer:function(){const path=window.location.pathname+window.location.hash;const linkSelectors=["#nav-login-link","#nav-logout-link",];for(const linkSelector of linkSelectors){const $link=$(linkSelector);if($link.length){this.setReturnTo($link,path);}}},setReturnTo:function($link,path,args){const url=new URL($link.prop("href"));url.search="return_to="+encodeURIComponent(path);if(args){url.search+="&"+$.map(Object.entries(args),e=>`${encodeURIComponent(e[0])}=${encodeURIComponent(e[1])}`).join("&");}
$link.attr("href",url.href);},getCookie:function(name,defaultValue){return Cookies.get(name)??defaultValue;},setCookie:function(name,value,options){Cookies.set(name,value,options);},deleteCookie:function(name,options){Cookies.remove(name,options);},}
for(const langData of window.OTTM_CONFIG.languages){ottm.languages.push(new Language(langData.code,langData.name,langData.writingDirection,langData.comma,langData.and,langData.dayNames,langData.abbrDayNames,langData.monthNames,langData.abbrMonthNames,langData.ampm,langData.decimalSep,langData.thousandsSep,));}
delete window.OTTM_CONFIG;$("#ottm-config-script").remove();ottm.setReferer();ottm.setAccessKeys();function hookSettingsDropdownBehavior(){const $button=$("#navbar-logged-out-settings");if($button.length){const $parent=$button.parent();const $menu=$parent.find(".dropdown-menu");$button.on("click",e=>{$parent.toggleClass("show");$menu.toggleClass("show");e.preventDefault();});$("body").on("click",e=>{if(!$.contains($parent[0],e.target)){$parent.removeClass("show");$menu.removeClass("show");}});}}
function hookDarkModeCallback(){$("#dark-mode-checkbox").on("click",e=>{const checked=$(e.target).prop("checked");Cookies.set('dark_mode',checked);location.reload();});}
function hookLanguageSelectorCallback(){$("#nav-language-select").on("change",e=>{const langCode=$(e.target).val();Cookies.set('language',langCode);location.reload();});}
hookSettingsDropdownBehavior();hookDarkModeCallback();hookLanguageSelectorCallback();})();