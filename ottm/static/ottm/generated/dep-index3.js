var Ks=Object.defineProperty;var gn=a=>{throw TypeError(a)};var Xs=(a,e,t)=>e in a?Ks(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var E=(a,e,t)=>Xs(a,typeof e!="symbol"?e+"":e,t),xi=(a,e,t)=>e.has(a)||gn("Cannot "+t);var n=(a,e,t)=>(xi(a,e,"read from private field"),t?t.call(a):e.get(a)),y=(a,e,t)=>e.has(a)?gn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),w=(a,e,t,i)=>(xi(a,e,"write to private field"),i?i.call(a,t):e.set(a,t),t),r=(a,e,t)=>(xi(a,e,"access private method"),t);var yn=(a,e,t,i)=>({set _(s){w(a,e,s,t)},get _(){return n(a,e,i)}});import{m as me}from"./dep-maplibre-gl.js";import{$ as It}from"./dep-jquery.js";import{g as Js,e as mn,d as X,r as oi,i as Qs,b as wn,a as tr,s as er,p as ir,f as Fi,m as nr,l as ai,c as sr,h as Ce,j as vn,k as rr,n as kn,o as B,q,O as zn}from"./dep-index.js";import"./index.js";var it=typeof window<"u"?window:null,rn=it===null,Ve=rn?void 0:it.document,at="addEventListener",lt="removeEventListener",Li="getBoundingClientRect",Ee="_a",ht="_b",bt="_c",Ye="horizontal",ct=function(){return!1},or=rn?"calc":["","-webkit-","-moz-","-o-"].filter(function(a){var e=Ve.createElement("div");return e.style.cssText="width:"+a+"calc(9px)",!!e.style.length}).shift()+"calc",An=function(a){return typeof a=="string"||a instanceof String},bn=function(a){if(An(a)){var e=Ve.querySelector(a);if(!e)throw new Error("Selector "+a+" did not match a DOM element");return e}return a},W=function(a,e,t){var i=a[e];return i!==void 0?i:t},Ze=function(a,e,t,i){if(e){if(i==="end")return 0;if(i==="center")return a/2}else if(t){if(i==="start")return 0;if(i==="center")return a/2}return a},ar=function(a,e){var t=Ve.createElement("div");return t.className="gutter gutter-"+e,t},lr=function(a,e,t){var i={};return An(e)?i[a]=e:i[a]=or+"("+e+"% - "+t+"px)",i},hr=function(a,e){var t;return t={},t[a]=e+"px",t},cr=function(a,e){if(e===void 0&&(e={}),rn)return{};var t=a,i,s,l,h,u,c;Array.from&&(t=Array.from(t));var p=bn(t[0]),g=p.parentNode,T=getComputedStyle?getComputedStyle(g):null,M=T?T.flexDirection:null,D=W(e,"sizes")||t.map(function(){return 100/t.length}),Y=W(e,"minSize",100),$t=Array.isArray(Y)?Y:t.map(function(){return Y}),jt=W(e,"maxSize",1/0),Gt=Array.isArray(jt)?jt:t.map(function(){return jt}),Bt=W(e,"expandToMin",!1),ve=W(e,"gutterSize",10),qe=W(e,"gutterAlign","center"),Ei=W(e,"snapOffset",30),$s=Array.isArray(Ei)?Ei:t.map(function(){return Ei}),Pi=W(e,"dragInterval",1),ee=W(e,"direction",Ye),Si=W(e,"cursor",ee===Ye?"col-resize":"row-resize"),js=W(e,"gutter",ar),hn=W(e,"elementStyle",lr),Gs=W(e,"gutterStyle",hr);ee===Ye?(i="width",s="clientX",l="left",h="right",u="clientWidth"):ee==="vertical"&&(i="height",s="clientY",l="top",h="bottom",u="clientHeight");function be(m,d,f,b){var U=hn(i,d,f,b);Object.keys(U).forEach(function(R){m.style[R]=U[R]})}function Bs(m,d,f){var b=Gs(i,d,f);Object.keys(b).forEach(function(U){m.style[U]=b[U]})}function Ue(){return c.map(function(m){return m.size})}function cn(m){return"touches"in m?m.touches[0][s]:m[s]}function un(m){var d=c[this.a],f=c[this.b],b=d.size+f.size;d.size=m/this.size*b,f.size=b-m/this.size*b,be(d.element,d.size,this[ht],d.i),be(f.element,f.size,this[bt],f.i)}function qs(m){var d,f=c[this.a],b=c[this.b];this.dragging&&(d=cn(m)-this.start+(this[ht]-this.dragOffset),Pi>1&&(d=Math.round(d/Pi)*Pi),d<=f.minSize+f.snapOffset+this[ht]?d=f.minSize+this[ht]:d>=this.size-(b.minSize+b.snapOffset+this[bt])&&(d=this.size-(b.minSize+this[bt])),d>=f.maxSize-f.snapOffset+this[ht]?d=f.maxSize+this[ht]:d<=this.size-(b.maxSize-b.snapOffset+this[bt])&&(d=this.size-(b.maxSize+this[bt])),un.call(this,d),W(e,"onDrag",ct)(Ue()))}function dn(){var m=c[this.a].element,d=c[this.b].element,f=m[Li](),b=d[Li]();this.size=f[i]+b[i]+this[ht]+this[bt],this.start=f[l],this.end=f[h]}function Us(m){if(!getComputedStyle)return null;var d=getComputedStyle(m);if(!d)return null;var f=m[u];return f===0?null:(ee===Ye?f-=parseFloat(d.paddingLeft)+parseFloat(d.paddingRight):f-=parseFloat(d.paddingTop)+parseFloat(d.paddingBottom),f)}function pn(m){var d=Us(g);if(d===null||$t.reduce(function(R,J){return R+J},0)>d)return m;var f=0,b=[],U=m.map(function(R,J){var Ut=d*R/100,He=Ze(ve,J===0,J===m.length-1,qe),We=$t[J]+He;return Ut<We?(f+=We-Ut,b.push(0),We):(b.push(Ut-We),Ut)});return f===0?m:U.map(function(R,J){var Ut=R;if(f>0&&b[J]-f>0){var He=Math.min(f,b[J]-f);f-=He,Ut=R-He}return Ut/d*100})}function Hs(){var m=this,d=c[m.a].element,f=c[m.b].element;m.dragging&&W(e,"onDragEnd",ct)(Ue()),m.dragging=!1,it[lt]("mouseup",m.stop),it[lt]("touchend",m.stop),it[lt]("touchcancel",m.stop),it[lt]("mousemove",m.move),it[lt]("touchmove",m.move),m.stop=null,m.move=null,d[lt]("selectstart",ct),d[lt]("dragstart",ct),f[lt]("selectstart",ct),f[lt]("dragstart",ct),d.style.userSelect="",d.style.webkitUserSelect="",d.style.MozUserSelect="",d.style.pointerEvents="",f.style.userSelect="",f.style.webkitUserSelect="",f.style.MozUserSelect="",f.style.pointerEvents="",m.gutter.style.cursor="",m.parent.style.cursor="",Ve.body.style.cursor=""}function Ws(m){if(!("button"in m&&m.button!==0)){var d=this,f=c[d.a].element,b=c[d.b].element;d.dragging||W(e,"onDragStart",ct)(Ue()),m.preventDefault(),d.dragging=!0,d.move=qs.bind(d),d.stop=Hs.bind(d),it[at]("mouseup",d.stop),it[at]("touchend",d.stop),it[at]("touchcancel",d.stop),it[at]("mousemove",d.move),it[at]("touchmove",d.move),f[at]("selectstart",ct),f[at]("dragstart",ct),b[at]("selectstart",ct),b[at]("dragstart",ct),f.style.userSelect="none",f.style.webkitUserSelect="none",f.style.MozUserSelect="none",f.style.pointerEvents="none",b.style.userSelect="none",b.style.webkitUserSelect="none",b.style.MozUserSelect="none",b.style.pointerEvents="none",d.gutter.style.cursor=Si,d.parent.style.cursor=Si,Ve.body.style.cursor=Si,dn.call(d),d.dragOffset=cn(m)-d.end}}D=pn(D);var qt=[];c=t.map(function(m,d){var f={element:bn(m),size:D[d],minSize:$t[d],maxSize:Gt[d],snapOffset:$s[d],i:d},b;if(d>0&&(b={a:d-1,b:d,dragging:!1,direction:ee,parent:g},b[ht]=Ze(ve,d-1===0,!1,qe),b[bt]=Ze(ve,!1,d===t.length-1,qe),M==="row-reverse"||M==="column-reverse")){var U=b.a;b.a=b.b,b.b=U}if(d>0){var R=js(d,ee,f.element);Bs(R,ve,d),b[Ee]=Ws.bind(b),R[at]("mousedown",b[Ee]),R[at]("touchstart",b[Ee]),g.insertBefore(R,f.element),b.gutter=R}return be(f.element,f.size,Ze(ve,d===0,d===t.length-1,qe),d),d>0&&qt.push(b),f});function fn(m){var d=m.i===qt.length,f=d?qt[m.i-1]:qt[m.i];dn.call(f);var b=d?f.size-m.minSize-f[bt]:m.minSize+f[ht];un.call(f,b)}c.forEach(function(m){var d=m.element[Li]()[i];d<m.minSize&&(Bt?fn(m):m.minSize=d)});function Ys(m){var d=pn(m);d.forEach(function(f,b){if(b>0){var U=qt[b-1],R=c[U.a],J=c[U.b];R.size=d[b-1],J.size=f,be(R.element,R.size,U[ht],R.i),be(J.element,J.size,U[bt],J.i)}})}function Zs(m,d){qt.forEach(function(f){if(d!==!0?f.parent.removeChild(f.gutter):(f.gutter[lt]("mousedown",f[Ee]),f.gutter[lt]("touchstart",f[Ee])),m!==!0){var b=hn(i,f.a.size,f[ht]);Object.keys(b).forEach(function(U){c[f.a].element.style[U]="",c[f.b].element.style[U]=""})}})}return{setSizes:Ys,getSizes:Ue,collapse:function(d){fn(c[d])},destroy:Zs,parent:g,pairs:qt}};function ur(a){return Js(a,(e,t)=>e+dr(t),0)}function dr(a){let e=0,t;switch(a.type){case"Polygon":return En(a.coordinates);case"MultiPolygon":for(t=0;t<a.coordinates.length;t++)e+=En(a.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function En(a){let e=0;if(a&&a.length>0){e+=Math.abs(Pn(a[0]));for(let t=1;t<a.length;t++)e-=Math.abs(Pn(a[t]))}return e}var pr=mn*mn/2,Ti=Math.PI/180;function Pn(a){const e=a.length-1;if(e<=2)return 0;let t=0,i=0;for(;i<e;){const s=a[i],l=a[i+1===e?0:i+1],h=a[i+2>=e?(i+2)%e:i+2],u=s[0]*Ti,c=l[1]*Ti,p=h[0]*Ti;t+=(p-u)*Math.sin(c),i++}return t*pr}function Ct(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return[...a.geometry.coordinates];if(a.type==="Point")return[...a.coordinates]}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return[...a];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function fr(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function on(a){return a.type==="Feature"?a.geometry:a}function li(a,e,t={}){if(t.final===!0)return gr(a,e);const i=Ct(a),s=Ct(e),l=X(i[0]),h=X(s[0]),u=X(i[1]),c=X(s[1]),p=Math.sin(h-l)*Math.cos(c),g=Math.cos(u)*Math.sin(c)-Math.sin(u)*Math.cos(c)*Math.cos(h-l);return oi(Math.atan2(p,g))}function gr(a,e){let t=li(e,a);return t=(t+180)%360,t}function Sn(a,e,t={}){let i;return t.final?i=xn(Ct(e),Ct(a)):i=xn(Ct(a),Ct(e)),i>180?-(360-i):i}function xn(a,e){const t=X(a[1]),i=X(e[1]);let s=X(e[0]-a[0]);s>Math.PI&&(s-=2*Math.PI),s<-Math.PI&&(s+=2*Math.PI);const l=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(t/2+Math.PI/4)),h=Math.atan2(s,l);return(oi(h)+360)%360}function yr(a,e,t,i={}){if(!Qs(i))throw new Error("options is invalid");if(!a)throw new Error("startPoint is required");if(!e)throw new Error("midPoint is required");if(!t)throw new Error("endPoint is required");const s=a,l=e,h=t,u=wn(i.mercator!==!0?li(s,l):Sn(s,l)),c=wn(i.mercator!==!0?li(h,l):Sn(h,l)),p=Math.abs(u-c);return i.explementary===!0?360-p:p}function Ft(a,e,t={}){var i=Ct(a),s=Ct(e),l=X(s[1]-i[1]),h=X(s[0]-i[0]),u=X(i[1]),c=X(s[1]),p=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(h/2),2)*Math.cos(u)*Math.cos(c);return tr(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)),t.units)}function mr(a,e={}){return er(a,(t,i)=>{const s=i.geometry.coordinates;return t+Ft(s[0],s[1],e)},0)}function Ln(a){return me.LngLat.convert(a.toArray())}function wr(a){return a.button===2}const Ie=class Ie{constructor(e,t){E(this,"lng");E(this,"lat");this.lng=e,this.lat=t}static sub(e,t){return new Ie(e.lng-t.lng,e.lat-t.lat)}addTo(e){return new me.LngLat(e.lng+this.lng,e.lat+this.lat)}};E(Ie,"ZERO",new Ie(0,0));let le=Ie;var gt=(a=>(a[a.NONE=0]="NONE",a[a.SELECTED=1]="SELECTED",a[a.HOVERED=2]="HOVERED",a))(gt||{});class Dn{constructor(e,t,i,s,l,h){E(this,"type","Feature");E(this,"geometry");E(this,"properties");E(this,"id");E(this,"dbId");E(this,"dataObject_",null);E(this,"dataTypesProvider");if(this.id=e,this.dbId=s??null,this.geometry=i,this.properties={color:"#ffffff",layer:0,selectionMode:0},this.dataTypesProvider=t,h){const u=this.geometry.type,c=h.type.getGeometryType();if(c!==u)throw new TypeError(`Invalid data object geometry type: expected "${u}", got "${c}"`);this.dataObject_=h}this.layer=l??0}get dataObject(){return this.dataObject_}get color(){return this.properties.color}get layer(){return this.properties.layer}set layer(e){this.properties.layer=e}get selectionMode(){return this.properties.selectionMode}set selectionMode(e){this.properties.selectionMode=e}copyDataOf(e){if(!e.dataObject)return;const t=this.geometry.type,i=e.dataObject.type.getGeometryType();if(t!==i)throw new TypeError(`Invalid geometry type: expected "${t}", got "${i}"`);this.dataObject_=e.dataObject,this.updateProperties()}}var zt,yt;class N extends Dn{constructor(t,i,s,l,h,u){super(t,i,{type:"Point",coordinates:[]},l,h,u);y(this,zt);y(this,yt,new Set);this.lngLat=s,this.updateProperties()}get lngLat(){return Ln(n(this,zt))}set lngLat(t){w(this,zt,Ln(t)),this.updateGeometry()}get radius(){return this.properties.radius}set radius(t){if(t<1)throw new Error(`Point radius is too small: ${t}`);this.properties.radius=t}get boundFeatures(){return[...n(this,yt)]}bindFeature(t){n(this,yt).add(t),this.updateProperties()}unbindFeature(t){n(this,yt).delete(t),this.updateProperties()}onDrag(t,i=le.ZERO){w(this,zt,i.addTo(t)),this.updateGeometry()}updateGeometry(){this.geometry.coordinates=n(this,zt).toArray();const{lng:t,lat:i}=n(this,zt);this.geometry.bbox=[t,i,t,i],n(this,yt).forEach(s=>{s.onVertexDrag(this)})}updateProperties(){this.properties.color=n(this,yt).size>1?"#bbbbbb":"#ffffff",this.dataObject?this.properties.radius=6:n(this,yt).size===0||n(this,yt).size===1&&[...this.boundFeatures].every(t=>t instanceof A&&t.isEndVertex(this))?this.properties.radius=5:this.properties.radius=3.5}}zt=new WeakMap,yt=new WeakMap;const ae=class ae extends Dn{onVertexDrag(e){this.updateGeometry(e)}isNearlyCircular(e){return 4*Math.PI*this.getArea(e)/this.getPerimeter(e)**2>=ae.CIRCULARITY_THRESHOLD}getArea(e){return vr(this.getRing(e))}getPerimeter(e){return br(this.getRing(e))}isNearlySquare(e){const t=this.getRing(e);for(let i=0;i<t.length;i++){const s=i==0?t[t.length-1]:t[i-1],l=t[i],h=i==t.length-1?t[0]:t[i+1],u=yr(s,l,h,{mercator:!0})%90,c=ae.RIGHT_ANGLE_THRESHOLD;if(u>c&&u<90-c)return!1}return!0}};E(ae,"CIRCULARITY_THRESHOLD",.6),E(ae,"RIGHT_ANGLE_THRESHOLD",5);let we=ae;var Qe=(a=>(a[a.FORWARD=1]="FORWARD",a[a.BACKWARD=-1]="BACKWARD",a))(Qe||{}),hi,S,ze,dt,Pt;const ci=class ci extends we{constructor(t,i,s,l,h,u){super(t,i,{type:"LineString",coordinates:[]},l,h,u);y(this,dt);y(this,S,[]);y(this,ze,1);if(s){if(s.length<2)throw new Error(`Expected at least 2 points, got ${s.length} in linestring ${l}`);for(let c=0;c<s.length;c++){const p=s[c],g=c.toString();if(!this.canAppendVertex(p,g))throw new Error(`Cannot append vertex ${p.id} at ${g}`);this.appendVertex(p,g)}}this.updateProperties()}get vertices(){return[...n(this,S)]}get width(){return this.properties.width}get direction(){return n(this,ze)}set direction(t){w(this,ze,t)}isEmpty(){return n(this,S).length===0}canAppendVertex(t,i){if(!this.canAcceptVertex(t))return!1;const s=r(this,dt,Pt).call(this,i);return s!==null&&(s===0||s===n(this,S).length)}appendVertex(t,i){this.canAppendVertex(t,i)&&(r(this,dt,Pt).call(this,i)===0?n(this,S).unshift(t):n(this,S).push(t),t.bindFeature(this),this.updateGeometry())}canAcceptVertex(t,i){const s=n(this,S).indexOf(t);if(s===-1)return!0;if(!i||this.isLoop())return!1;const l=r(this,dt,Pt).call(this,i);if(l===null||Math.abs(s-l)<=2)return!1;const h=n(this,S).length-1;return s===0&&l===h||s===h&&l===0}replaceVertex(t,i){if(!this.canAcceptVertex(t,this.getVertexPath(i)))return;let s=n(this,S).indexOf(i);do n(this,S)[s]=t,s=n(this,S).indexOf(i);while(s!==-1);t.bindFeature(this),i.unbindFeature(this),this.updateGeometry()}canInsertVertex(t,i){if(!this.canAcceptVertex(t))return!1;const s=r(this,dt,Pt).call(this,i);return s!==null&&s<n(this,S).length-1}insertVertexAfter(t,i){if(!this.canInsertVertex(t,i))return;const s=r(this,dt,Pt).call(this,i);s!==null&&(n(this,S).splice(s+1,0,t),t.bindFeature(this),this.updateGeometry())}removeVertex(t){let i=n(this,S).indexOf(t);if(i!==-1){if(n(this,S).length<=2||this.isLoop()&&n(this,S).length===3)return{type:"delete_feature"};do n(this,S).splice(i,1),i=n(this,S).indexOf(t);while(i!==-1);t.unbindFeature(this),this.updateGeometry()}return{type:"do_nothing"}}getVertex(t){const i=r(this,dt,Pt).call(this,t);return i!==null&&i<n(this,S).length?n(this,S)[i]:null}getSegmentVertices(t){const i=r(this,dt,Pt).call(this,t);return i!==null&&i<n(this,S).length-1?[n(this,S)[i],n(this,S)[i+1]]:null}incrementPath(t){const i=r(this,dt,Pt).call(this,t);return i!==null?((i+1)%n(this,S).length).toString():null}getSegmentPath(t,i){const s=n(this,S).indexOf(t),l=n(this,S).indexOf(i);if(s!==-1&&l!==-1){if(s===l-1)return s.toString();if(l===s-1)return l.toString()}return null}getVertexPath(t){const i=n(this,S).indexOf(t);return i!==-1?i.toString():null}getNextVertexPath(){return n(this,S).length.toString()}isEndVertex(t){if(this.isLoop())return!1;const i=n(this,S).indexOf(t);return i===0||i===n(this,S).length-1}isLoop(){return n(this,S).length>1&&n(this,S)[0]===n(this,S)[n(this,S).length-1]}isNearlyCircular(t){return this.isLoop()&&super.isNearlyCircular(t)}getArea(t){if(!this.isLoop())throw new Error("LineString is not a loop");return super.getArea(t)}getPerimeter(t){if(!this.isLoop())throw new Error("LineString is not a loop");return super.getPerimeter(t)}isNearlySquare(t){return this.isLoop()&&super.isNearlySquare(t)}getRing(t){if(t!==0)throw new Error(`Invalid ring index: ${t}`);return n(this,S).slice(0,n(this,S).length-1)}isNearlyStraight(){return!1}updateGeometry(t){this.geometry.coordinates=[];let i=1/0,s=1/0,l=-1/0,h=-1/0;for(const u of n(this,S)){const{lng:c,lat:p}=u.lngLat;this.geometry.coordinates.push([c,p]),i=Math.min(c,i),s=Math.min(p,s),l=Math.max(c,l),h=Math.max(p,h)}this.geometry.bbox=[i,s,l,h],t?t.updateProperties():n(this,S).forEach(u=>{u.updateProperties()})}updateProperties(){if(!this.dataObject)this.properties.width=2,this.properties.color="#ffffff",this.properties.dash=null,this.properties.fgColor="#ffffff",this.properties.fgWidth=0,this.properties.fgDash=null;else if(this.dataObject.isInstanceOf(this.dataTypesProvider("track_section","ObjectType"))){this.properties.width=6,this.dataObject.isInstanceOf(this.dataTypesProvider("conventional_track_section","ObjectType"))&&this.dataObject.getPropertyValues("gauges").some(l=>l>=1435)&&(this.properties.width=8),this.properties.dash=null,this.properties.fgWidth=2,this.properties.fgDash=[4,4];let t;switch(this.dataObject.getPropertyValue("level")){case"bridge":t="#131313";break;case"tunnel":t="#9b9b9b";break;case"surface":default:t="#3d3d3d";break}this.properties.color=t,this.properties.fgColor="#ffffff"}}};hi=new WeakMap,S=new WeakMap,ze=new WeakMap,dt=new WeakSet,Pt=function(t){const i=n(ci,hi).exec(t);return i?+i[1]:null},y(ci,hi,/^(\d+)$/);let A=ci;var ui,L,At,mt,Mt;const di=class di extends we{constructor(t,i,s,l,h,u){super(t,i,{type:"Polygon",coordinates:[[]]},l,h,u);y(this,mt);y(this,L,[]);y(this,At,[]);if(s){for(let c=0;c<s.length;c++){const p=s[c];if(p.length<3)throw new Error(`Expected at least 3 points, got ${p.length} in ring ${c} of polygon ${l}`)}for(let c=0;c<s.length;c++){const p=s[c];for(let g=0;g<p.length;g++){const T=p[g],M=`${c}.${g}`;if(!this.canAppendVertex(T,M))throw new Error(`Cannot append vertex ${T.id} at ${M}`);this.appendVertex(T,M)}this.lockRing(c),p.forEach(g=>{g.updateProperties()})}}else n(this,At).push(!1);this.updateProperties()}get vertices(){const t=[];for(const i of n(this,L))t.push([...i]);return t}isRingLocked(t){return n(this,At)[t]??!1}lockRing(t){typeof n(this,At)[t]<"u"&&(n(this,At)[t]=!0)}isEmpty(){return!n(this,L)[0]||n(this,L)[0].length===0}canAppendVertex(t,i){const s=r(this,mt,Mt).call(this,i);return!this.canAcceptVertex(t)||s===null||this.isRingLocked(s[0])?!1:s[0]<n(this,L).length&&(s[1]===0||s[1]===n(this,L)[s[0]].length)||s[0]===n(this,L).length&&s[1]===0}appendVertex(t,i){if(!this.canAppendVertex(t,i))return;const s=r(this,mt,Mt).call(this,i);if(s===null)return;const[l,h]=s;let u;l===n(this,L).length?(n(this,L).push(u=[]),n(this,At).push(!1)):u=n(this,L)[l],h===0?u.unshift(t):u.push(t),t.bindFeature(this),this.updateGeometry()}canAcceptVertex(t){return!n(this,L).some(i=>i.includes(t))}replaceVertex(t,i){if(this.canAcceptVertex(t))for(const s of n(this,L)){const l=s.indexOf(i);if(l!==-1){s[l]=t,t.bindFeature(this),i.unbindFeature(this),this.updateGeometry();return}}}canInsertVertex(t,i){if(!this.canAcceptVertex(t))return!1;const s=r(this,mt,Mt).call(this,i);return s!==null&&s[0]<n(this,L).length&&s[1]<n(this,L)[s[0]].length}insertVertexAfter(t,i){if(!this.canInsertVertex(t,i))return;const s=r(this,mt,Mt).call(this,i);if(s===null)return;const[l,h]=s;t.bindFeature(this);const u=n(this,L)[l];h===u.length-1?u.push(t):u.splice(h+1,0,t),this.updateGeometry()}removeVertex(t){for(let i=0;i<n(this,L).length;i++){const s=n(this,L)[i],l=s.indexOf(t);if(l!==-1)return s.length<=3?i===0?{type:"delete_feature"}:{type:"delete_ring",ringIndex:i,points:s}:(s.splice(l,1),t.unbindFeature(this),this.updateGeometry(),{type:"do_nothing"})}return{type:"do_nothing"}}getVertex(t){const i=r(this,mt,Mt).call(this,t);return i!==null&&i[0]<n(this,L).length&&i[1]<n(this,L)[i[0]].length?n(this,L)[i[0]][i[1]]:null}getSegmentVertices(t){const i=r(this,mt,Mt).call(this,t);if(i!==null&&i[0]<n(this,L).length&&i[1]<n(this,L)[i[0]].length){const s=n(this,L)[i[0]];return[s[i[1]],s[(i[1]+1)%s.length]]}else return null}incrementPath(t){const i=r(this,mt,Mt).call(this,t);return i!==null&&i[0]<n(this,L).length?`${i[0]}.${(i[1]+1)%n(this,L)[i[0]].length}`:null}getSegmentPath(t,i){for(const s of n(this,L)){const l=s.indexOf(t),h=s.indexOf(i);if(l!==-1&&h!==-1){if(l===h-1)return l.toString();if(h===l-1)return h.toString();break}else if(l===-1&&h!==-1||l!==-1&&h===-1)break}return null}getVertexPath(t){for(let i=0;i<n(this,L).length;i++){const s=n(this,L)[i].indexOf(t);if(s!==-1)return`${i}.${s}`}return null}getNextVertexPath(){var t;return`0.${((t=n(this,L)[0])==null?void 0:t.length)??0}`}deleteRing(t){0<t&&t<n(this,L).length&&(n(this,L)[t].forEach(i=>{i.unbindFeature(this)}),n(this,L).splice(t,1),this.updateGeometry())}getRing(t){const i=n(this,L)[t];if(typeof i<"u")throw new Error(`Invalid ring index: ${t}`);return[...i]}updateGeometry(t){this.geometry.coordinates=[];let i=1/0,s=1/0,l=-1/0,h=-1/0;for(const u of n(this,L)){const c=[];for(const p of u){const{lng:g,lat:T}=p.lngLat;c.push([g,T]),i=Math.min(g,i),s=Math.min(T,s),l=Math.max(g,l),h=Math.max(T,h)}c.push(u[0].lngLat.toArray()),this.geometry.coordinates.push(c)}this.geometry.bbox=[i,s,l,h],t?t.updateProperties():n(this,L).forEach(u=>{u.forEach(c=>{c.updateProperties()})})}updateProperties(){}};ui=new WeakMap,L=new WeakMap,At=new WeakMap,mt=new WeakSet,Mt=function(t){const i=n(di,ui).exec(t);return i?[+i[1],+i[2]]:null},y(di,ui,/^(\d+)\.(\d+)$/);let Q=di;function vr(a){return ur(Nn(a))}function br(a){return mr(Nn(a),{units:"meters"})}function Nn(a){return ir([[...a,a[0]].map(e=>e.lngLat.toArray())])}var Ae;class Er{constructor(e,t){E(this,"label");E(this,"localizedName");y(this,Ae,new Set);this.label=e,this.localizedName=t}get units(){return new Set(n(this,Ae))}addUnit(e){if(e.type!==this)throw new TypeError(`Invalid unit type: expected "${this.label}", got "${e.type.label}"`);n(this,Ae).add(e)}}Ae=new WeakMap;class Pr{constructor(e,t,i){E(this,"type");E(this,"symbol");E(this,"isDefault");this.type=e,this.symbol=t,this.isDefault=i}}var ce;class Sr{constructor(e,t,i){E(this,"label");E(this,"localizedName");y(this,ce);if(this.label=e,this.localizedName=t,w(this,ce,{...i}),this.values.length===0)throw new Error(`Empty enumeration "${e}"`)}get values(){return Object.keys(n(this,ce))}get valuesTranslations(){return Object.entries(n(this,ce))}}ce=new WeakMap;var De,ue;class ie{constructor(e,t,i=null,s=null,l=!1,h=!1){E(this,"label");E(this,"localizedName");E(this,"parentType");E(this,"isDeprecated");E(this,"isTemporal");y(this,De);y(this,ue,new Map);this.label=e,this.localizedName=t,this.parentType=i,this.isTemporal=l,this.isDeprecated=h,w(this,De,s)}get properties(){const e=[];let t=this;do e.splice(0,0,...n(t,ue).values()),t=t.parentType;while(t);return e}getProperty(e){const t=n(this,ue).get(e);return!t&&this.parentType?this.parentType.getProperty(e):t??null}addProperty(e){if(e.objectType!==this)throw new TypeError(`Expected type "${this.label}", got "${e.objectType.label}"`);if(this.getProperty(e.label))throw new Error(`Object type ${this.label} already has a property named "${e.label}"`);n(this,ue).set(e.label,e)}isSameOrSubtypeOf(e){var t;return this===e||(((t=this.parentType)==null?void 0:t.isSameOrSubtypeOf(e))??!1)}getGeometryType(){var e;return n(this,De)??((e=this.parentType)==null?void 0:e.getGeometryType())??null}}De=new WeakMap,ue=new WeakMap;class an{constructor(e,t,i,s,l){E(this,"objectType");E(this,"fullName");E(this,"label");E(this,"localizedName");E(this,"isUnique");E(this,"isDeprecated");this.objectType=e,this.fullName=`${e.label}.${t}`,this.label=t,this.localizedName=i,this.isUnique=s,this.isDeprecated=l}isValueCompatible(e){return this.label===e.propertyType.label&&this.isUnique===e.propertyType.isUnique&&(!e.propertyType.isUnique&&e.values.every(t=>this.isValueValid(t))||e.propertyType.isUnique&&this.isValueValid(e.value))}}var pt,Z,Pe,Se,Ci;class ln{constructor(e,...t){y(this,Z);E(this,"propertyType");y(this,pt,[]);if(this.propertyType=e,t.length===0)throw new Error(`Missing value for property ${this.propertyType.fullName}`);if(e.isUnique){if(t.length!==1)throw new Error(`Property ${this.propertyType.fullName} expected 1 value, got ${t.length}`);this.value=t[0]}else this.values=t}get value(){return r(this,Z,Ci).call(this),n(this,pt)[0]}set value(e){r(this,Z,Ci).call(this),r(this,Z,Pe).call(this,e),n(this,pt)[0]=e}get values(){return r(this,Z,Se).call(this),[...n(this,pt)]}set values(e){r(this,Z,Se).call(this),e.forEach(t=>{r(this,Z,Pe).call(this,t)}),n(this,pt).splice(0,n(this,pt).length,...e)}addValue(e){r(this,Z,Se).call(this),r(this,Z,Pe).call(this,e),n(this,pt).push(e)}removeValue(e){r(this,Z,Se).call(this),r(this,Z,Pe).call(this,e);const t=n(this,pt).indexOf(e);t!==-1&&n(this,pt).splice(t,1)}}pt=new WeakMap,Z=new WeakSet,Pe=function(e){if(!this.propertyType.isValueValid(e))throw new Error(`Invalid value for property "${this.propertyType.fullName}"`)},Se=function(){if(this.propertyType.isUnique)throw new TypeError(`Property "${this.propertyType.fullName}" is unique`)},Ci=function(){if(!this.propertyType.isUnique)throw new TypeError(`Property "${this.propertyType.fullName}" is not unique`)};class ti extends an{constructor(t,i,s,l,h,u,c,p){super(t,i,s,l,h);E(this,"min");E(this,"max");E(this,"unitType");if(typeof u=="number"&&typeof c=="number"&&u>c)throw new Error("min > max");this.min=u??null,this.max=c??null,this.unitType=p??null}isValueValid(t){return typeof t=="number"&&(this.min===null||t>=this.min)&&(this.max===null||t<=this.max)}}class xr extends ti{newValue(e,t){return new Tr(this,t,e)}}class Oi extends an{constructor(t,i,s,l,h,u,c){super(t,i,s,l,h);E(this,"isMultiline");E(this,"isTranslatable");this.isMultiline=u,this.isTranslatable=c}isValueValid(t){return typeof t=="string"&&(this.isMultiline||!t.includes(`
`)&&!t.includes("\r"))}newValue(t,i){return new ei(this,i?[i]:[],t)}}class Lr extends an{constructor(t,i,s,l,h,u){super(t,i,s,l,h);E(this,"enumType");this.enumType=u}isValueValid(t){return typeof t=="string"&&this.enumType.values.some(i=>i===t)}newValue(t){return new Or(this,t)}}var ft,Ne,wt,H,et,Mi,_e,Vi;const Me=class Me{constructor(e,t,i){y(this,H);E(this,"id");y(this,ft);y(this,Ne,null);y(this,wt,new Map);w(this,ft,e),this.id=i??null,this.existenceInterval=t??null}get type(){return n(this,ft)}set type(e){var t;if(e!==n(this,ft)){const i=n(this,ft).getGeometryType(),s=e.getGeometryType();if(i!==s)throw new TypeError(`Incompatible geometry type, expected "${i}", got "${s}"`);const l={};for(const[h,u]of n(this,wt))(t=e.getProperty(h))!=null&&t.isValueCompatible(u)&&(l[h]=u);n(this,wt).clear();for(const[h,u]of Object.entries(l))if(u.propertyType.isUnique)this.setPropertyValue(h,u.value);else for(const c of u.values)this.addValueToProperty(h,c);w(this,ft,e)}}get existenceInterval(){return n(this,Ne)}set existenceInterval(e){if(!this.type.isTemporal&&e)throw new Error("Object is not temporal");if(this.type.isTemporal&&!e)throw new Error("Missing existence interval for temporal object");w(this,Ne,e)}getPropertyValue(e){const{value:t}=r(this,H,et).call(this,e);return t==null?void 0:t.value}setPropertyValue(e,t){const{property:i,value:s}=r(this,H,et).call(this,e);s?s.value=t:r(this,H,Mi).call(this,i,t)}getPropertyValues(e){const{value:t}=r(this,H,et).call(this,e);return(t==null?void 0:t.values)??[]}addValueToProperty(e,t){const{property:i,value:s}=r(this,H,et).call(this,e);s?s.addValue(t):r(this,H,Mi).call(this,i,t)}removeValueFromProperty(e,t){const{value:i}=r(this,H,et).call(this,e);i&&(i.removeValue(t),i.values.length===0&&n(this,wt).delete(e))}deleteProperty(e){const{value:t}=r(this,H,et).call(this,e);t&&n(this,wt).delete(e)}getPropertyUnit(e){var s;const{property:t,value:i}=r(this,H,et).call(this,e);if(!(t instanceof ti)||i&&!r(s=Me,_e,Vi).call(s,i)||!t.unitType)throw new TypeError(`Property "${t.fullName}" does not have a unit`);return(i==null?void 0:i.unit)??null}setPropertyUnit(e,t){var l;const{property:i,value:s}=r(this,H,et).call(this,e);if(!(i instanceof ti)||s&&!r(l=Me,_e,Vi).call(l,s)||!i.unitType)throw new TypeError(`Property "${i.fullName}" does not have a unit`);if(!s)throw new Error(`Property "${i.fullName}" is not bound yet`);s.unit=t}getPropertyValueTranslations(e,t){const{property:i,value:s}=r(this,H,et).call(this,e);if(!(i instanceof Oi)||s&&!(s instanceof ei)||!i.isTranslatable)throw new TypeError(`Property "${i.fullName}" is not translatable`);return(s==null?void 0:s.translations[t??0])??null}setPropertyValueTranslation(e,t,i,s){const{property:l,value:h}=r(this,H,et).call(this,e);if(!(l instanceof Oi)||h&&!(h instanceof ei)||!l.isTranslatable)throw new TypeError(`Property "${l.fullName}" is not translatable`);h==null||h.setTranslation(t,i,s)}removePropertyValueTranslation(e,t,i){const{property:s,value:l}=r(this,H,et).call(this,e);if(!(s instanceof Oi)||l&&!(l instanceof ei)||!s.isTranslatable)throw new TypeError(`Property "${s.fullName}" is not translatable`);l==null||l.removeTranslation(t,i)}isInstanceOf(e){return n(this,ft).isSameOrSubtypeOf(e)}};ft=new WeakMap,Ne=new WeakMap,wt=new WeakMap,H=new WeakSet,et=function(e){const t=n(this,ft).getProperty(e);if(!t)throw new TypeError(`Undefined property "${e}" for object of type "${n(this,ft).label}"`);return{property:t,value:n(this,wt).get(e)}},Mi=function(e,t){const i=e.label;if(e instanceof ti){if(typeof t!="number")throw new TypeError(`Expected number, got ${typeof t}`);n(this,wt).set(i,e.newValue(t,e.unitType?[...e.unitType.units].find(s=>s.isDefault):void 0))}else n(this,wt).set(i,e.newValue(t))},_e=new WeakSet,Vi=function(e){return e instanceof _n},y(Me,_e);let Ii=Me;var Re;class _n extends ln{constructor(t,i,...s){super(t,...s);y(this,Re,null);if(t.unitType&&!i)throw new Error(`Missing unit for property ${t.fullName}`);i&&(this.unit=i)}get unit(){return n(this,Re)}set unit(t){const i=this.propertyType.unitType;if(!i)throw new TypeError(`Unexpected unit for property "${this.propertyType.fullName}"`);const s=t.type;if(i!==s)throw new TypeError(`Invalid unit type for property "${this.propertyType.fullName}": expected "${i.label}", got "${s}"`);w(this,Re,t)}}Re=new WeakMap;class Tr extends _n{}var Zt,de,ii;class ei extends ln{constructor(t,i,...s){super(t,...s);y(this,de);y(this,Zt);if(i&&r(this,de,ii).call(this),i&&i.length>s.length)throw new Error("Too many translations");w(this,Zt,(i==null?void 0:i.map(l=>new Map(Object.entries(l))))??[])}get translations(){return structuredClone(n(this,Zt))}setTranslation(t,i,s){r(this,de,ii).call(this),n(this,Zt)[s??0].set(t,i)}removeTranslation(t,i){r(this,de,ii).call(this),n(this,Zt)[i??0].delete(t)}}Zt=new WeakMap,de=new WeakSet,ii=function(){if(!this.propertyType.isTranslatable)throw new Error(`Property "${this.propertyType.fullName}" is not translatable`)};class Or extends ln{}class Rn{constructor(e){E(this,"type");this.type=e}}const pi=class pi extends Rn{constructor(t=[]){super(pi.TYPE);E(this,"features");this.features=t}};E(pi,"TYPE","editor.selection");let he=pi;const fi=class fi extends Rn{constructor(t){super(fi.TYPE);E(this,"feature");this.feature=t}};E(fi,"TYPE","editor.hover");let ke=fi;function Fr(a,e={}){const t=on(a);switch(!e.properties&&a.type==="Feature"&&(e.properties=a.properties),t.type){case"Polygon":return Cr(t,e);case"MultiPolygon":return Ir(t,e);default:throw new Error("invalid poly")}}function Cr(a,e={}){const i=on(a).coordinates,s=e.properties?e.properties:a.type==="Feature"?a.properties:{};return $n(i,s)}function Ir(a,e={}){const i=on(a).coordinates,s=e.properties?e.properties:a.type==="Feature"?a.properties:{},l=[];return i.forEach(h=>{l.push($n(h,s))}),Fi(l)}function $n(a,e){return a.length>1?nr(a,e):ai(a[0],e)}function Tn(a,e,t,i={}){const s=Ct(a),l=X(s[0]),h=X(s[1]),u=X(t),c=sr(e,i.units),p=Math.asin(Math.sin(h)*Math.cos(c)+Math.cos(h)*Math.sin(c)*Math.cos(u)),g=l+Math.atan2(Math.sin(u)*Math.sin(c)*Math.cos(h),Math.cos(c)-Math.sin(h)*Math.sin(p)),T=oi(g),M=oi(p);return Ce([T,M],i.properties)}class jn{constructor(e=[],t=Mr){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:i}=this,s=t[e];for(;e>0;){const l=e-1>>1,h=t[l];if(i(s,h)>=0)break;t[e]=h,e=l}t[e]=s}_down(e){const{data:t,compare:i}=this,s=this.length>>1,l=t[e];for(;e<s;){let h=(e<<1)+1,u=t[h];const c=h+1;if(c<this.length&&i(t[c],u)<0&&(h=c,u=t[c]),i(u,l)>=0)break;t[e]=u,e=h}t[e]=l}}function Mr(a,e){return a<e?-1:a>e?1:0}function Gn(a,e){return a.p.x>e.p.x?1:a.p.x<e.p.x?-1:a.p.y!==e.p.y?a.p.y>e.p.y?1:-1:1}function Vr(a,e){return a.rightSweepEvent.p.x>e.rightSweepEvent.p.x?1:a.rightSweepEvent.p.x<e.rightSweepEvent.p.x?-1:a.rightSweepEvent.p.y!==e.rightSweepEvent.p.y?a.rightSweepEvent.p.y<e.rightSweepEvent.p.y?1:-1:1}class On{constructor(e,t,i,s){this.p={x:e[0],y:e[1]},this.featureId=t,this.ringId=i,this.eventId=s,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(e){return this.p.x===e.p.x&&this.p.y===e.p.y}}function kr(a,e){if(a.type==="FeatureCollection"){const t=a.features;for(let i=0;i<t.length;i++)Fn(t[i],e)}else Fn(a,e)}let Ke=0,Xe=0,Je=0;function Fn(a,e){const t=a.type==="Feature"?a.geometry:a;let i=t.coordinates;(t.type==="Polygon"||t.type==="MultiLineString")&&(i=[i]),t.type==="LineString"&&(i=[[i]]);for(let s=0;s<i.length;s++)for(let l=0;l<i[s].length;l++){let h=i[s][l][0],u=null;Xe=Xe+1;for(let c=0;c<i[s][l].length-1;c++){u=i[s][l][c+1];const p=new On(h,Ke,Xe,Je),g=new On(u,Ke,Xe,Je+1);p.otherEvent=g,g.otherEvent=p,Gn(p,g)>0?(g.isLeftEndpoint=!0,p.isLeftEndpoint=!1):(p.isLeftEndpoint=!0,g.isLeftEndpoint=!1),e.push(p),e.push(g),h=u,Je=Je+1}}Ke=Ke+1}class zr{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}function Ar(a,e){if(a===null||e===null||a.leftSweepEvent.ringId===e.leftSweepEvent.ringId&&(a.rightSweepEvent.isSamePoint(e.leftSweepEvent)||a.rightSweepEvent.isSamePoint(e.leftSweepEvent)||a.rightSweepEvent.isSamePoint(e.rightSweepEvent)||a.leftSweepEvent.isSamePoint(e.leftSweepEvent)||a.leftSweepEvent.isSamePoint(e.rightSweepEvent)))return!1;const t=a.leftSweepEvent.p.x,i=a.leftSweepEvent.p.y,s=a.rightSweepEvent.p.x,l=a.rightSweepEvent.p.y,h=e.leftSweepEvent.p.x,u=e.leftSweepEvent.p.y,c=e.rightSweepEvent.p.x,p=e.rightSweepEvent.p.y,g=(p-u)*(s-t)-(c-h)*(l-i),T=(c-h)*(i-u)-(p-u)*(t-h),M=(s-t)*(i-u)-(l-i)*(t-h);if(g===0)return!1;const D=T/g,Y=M/g;if(D>=0&&D<=1&&Y>=0&&Y<=1){const $t=t+D*(s-t),jt=i+D*(l-i);return[$t,jt]}return!1}function Dr(a,e){e=e||!1;const t=[],i=new jn([],Vr);for(;a.length;){const s=a.pop();if(s.isLeftEndpoint){const l=new zr(s);for(let h=0;h<i.data.length;h++){const u=i.data[h];if(e&&u.leftSweepEvent.featureId===s.featureId)continue;const c=Ar(l,u);c!==!1&&t.push(c)}i.push(l)}else s.isLeftEndpoint===!1&&i.pop()}return t}function Nr(a,e){const t=new jn([],Gn);return kr(a,t),Dr(t,e)}var _r=Nr;function Rr(a,e,t={}){const{removeDuplicates:i=!0,ignoreSelfIntersections:s=!1}=t;let l=[];a.type==="FeatureCollection"?l=l.concat(a.features):a.type==="Feature"?l.push(a):(a.type==="LineString"||a.type==="Polygon"||a.type==="MultiLineString"||a.type==="MultiPolygon")&&l.push(vn(a)),e.type==="FeatureCollection"?l=l.concat(e.features):e.type==="Feature"?l.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&l.push(vn(e));const h=_r(Fi(l),s);let u=[];if(i){const c={};h.forEach(p=>{const g=p.join(",");c[g]||(c[g]=!0,u.push(p))})}else u=h;return Fi(u.map(c=>Ce(c)))}var $r=Object.defineProperty,jr=Object.defineProperties,Gr=Object.getOwnPropertyDescriptors,Cn=Object.getOwnPropertySymbols,Br=Object.prototype.hasOwnProperty,qr=Object.prototype.propertyIsEnumerable,In=(a,e,t)=>e in a?$r(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,Ht=(a,e)=>{for(var t in e||(e={}))Br.call(e,t)&&In(a,t,e[t]);if(Cn)for(var t of Cn(e))qr.call(e,t)&&In(a,t,e[t]);return a},Wt=(a,e)=>jr(a,Gr(e));function Mn(a,e,t={}){if(!a||!e)throw new Error("lines and pt are required arguments");let i=Ce([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),s=0;return rr(a,function(l,h,u){const c=fr(l);for(let p=0;p<c.length-1;p++){const g=Ce(c[p]);g.properties.dist=Ft(e,g,t);const T=Ce(c[p+1]);T.properties.dist=Ft(e,T,t);const M=Ft(g,T,t),D=Math.max(g.properties.dist,T.properties.dist),Y=li(g,T),$t=Tn(e,D,Y+90,t),jt=Tn(e,D,Y-90,t),Gt=Rr(ai([$t.geometry.coordinates,jt.geometry.coordinates]),ai([g.geometry.coordinates,T.geometry.coordinates]));let Bt;Gt.features.length>0&&Gt.features[0]&&(Bt=Wt(Ht({},Gt.features[0]),{properties:{dist:Ft(e,Gt.features[0],t),multiFeatureIndex:u,location:s+Ft(g,Gt.features[0],t)}})),g.properties.dist<i.properties.dist&&(i=Wt(Ht({},g),{properties:Wt(Ht({},g.properties),{index:p,multiFeatureIndex:u,location:s})})),T.properties.dist<i.properties.dist&&(i=Wt(Ht({},T),{properties:Wt(Ht({},T.properties),{index:p+1,multiFeatureIndex:u,location:s+M})})),Bt&&Bt.properties.dist<i.properties.dist&&(i=Wt(Ht({},Bt),{properties:Wt(Ht({},Bt.properties),{index:p})})),s+=M}}),i}function Vn(a,e,t,i=5){const s=Yr(a,e);if(!s||s.dist*1e3>i*Wr(s.lngLat.lat,t))return null;if(s.feature instanceof N)return{type:"point",point:s.feature};if(Bn(s.feature)){const l=Ur(s,e,.0025);if(l)return{type:"segment_vertex",feature:s.feature,path:l};if(s.path)return{type:"segment",feature:s.feature,path:s.path,lngLat:s.lngLat}}return null}function Bn(a){return a instanceof we}function Ur(a,e,t){if(!a.segment||!a.path||!Bn(a.feature))return null;const[i,s]=a.segment,l=e.includes(i),h=e.includes(s);if(!l&&!h)return null;const u=[a.lngLat.lng,a.lngLat.lat],c=Ft(i.lngLat.toArray(),u),p=Ft(s.lngLat.toArray(),u);return l&&!h||l&&h&&c<p?c<t?a.path:null:(!l&&h||l&&h&&p<c)&&p<t?a.feature.incrementPath(a.path):null}const Hr=40075017;function Wr(a,e){const t=a*(Math.PI/180);return Hr*Math.cos(t)/2**(e+8)}function Yr(a,e){let t=null;for(const i of e)if(i instanceof N){const s=Ft(a.toArray(),i);(!t||s<t.dist)&&(t={lngLat:i.lngLat,dist:s,feature:i})}else if(i instanceof A){const s=Mn(i,a.toArray());if((!t||s.properties.dist<t.dist)&&s.properties.index<i.vertices.length-1){const l=s.properties.index.toString();t={lngLat:me.LngLat.convert(s.geometry.coordinates),dist:s.properties.dist,feature:i,path:l,segment:i.getSegmentVertices(l)??void 0}}}else if(i instanceof Q){const s=Fr(i);let l;s.geometry.type==="LineString"?l=[s.geometry.coordinates]:l=s.geometry.coordinates;for(let h=0;h<l.length;h++){const u=l[h],c=Mn(ai(u),a.toArray());if(!t||c.properties.dist<t.dist){const p=`${h}.${c.properties.index}`;t={lngLat:me.LngLat.convert(c.geometry.coordinates),dist:c.properties.dist,feature:i,path:p,segment:i.getSegmentVertices(p)??void 0}}}}return t}var Dt,nt;class Zr{constructor(e){y(this,Dt);y(this,nt,[]);w(this,Dt,kn("maplibregl-ctrl-draw")),n(this,nt).push(B({title:e.drawPointButtonTitle??"Draw Point",icon:q("map-marker-outline"),onClick:t=>{t.classList.add("active"),e.onDrawPoint()},shortcut:["1"]})),n(this,nt).push(B({title:e.drawLineButtonTitle??"Draw Line",icon:q("vector-line"),onClick:t=>{t.classList.add("active"),e.onDrawLine()},shortcut:["2"]})),n(this,nt).push(B({title:e.drawPolygonButtonTitle??"Draw Area",icon:q("vector-polygon"),onClick:t=>{t.classList.add("active"),e.onDrawPolygon()},shortcut:["3"]})),It("body").on("keydown",t=>{const i=+t.key-1;i>=0&&i<n(this,nt).length&&n(this,nt)[i].click()})}deactivateButton(e){var t;(t=n(this,nt)[e])==null||t.classList.remove("active")}setButtonDisabled(e,t){n(this,nt)[e]&&(n(this,nt)[e].disabled=t)}onAdd(e){return n(this,Dt).append(...n(this,nt)),n(this,Dt)}onRemove(){var e;(e=n(this,Dt).parentNode)==null||e.removeChild(n(this,Dt))}}Dt=new WeakMap,nt=new WeakMap;class Kr{}var st,$e,Kt;class Xr extends Kr{constructor(t){super();y(this,st);y(this,$e);y(this,Kt);w(this,st,It('<button id="feature-type-btn" class="btn btn-secondary"></button>')),n(this,st).on("click",t.onClick),w(this,$e,It("<img>")),w(this,Kt,It("<span></span>")),n(this,st).append(n(this,$e),n(this,Kt))}get disabled(){return!!n(this,st).prop("disabled")}set disabled(t){n(this,st).prop("disabled",t)}setFeatureType(t){n(this,Kt).text((t==null?void 0:t.localizedName)??"")}setFeatureTypes(t){if(!t.length)this.setFeatureType(null);else{const i=t.map(s=>s.localizedName);n(this,Kt).text([...i].join(", "))}}get container(){return n(this,st)}get visible(){return n(this,st).is(":visible")}set visible(t){t?n(this,st).show():n(this,st).hide()}}st=new WeakMap,$e=new WeakMap,Kt=new WeakMap;var pe,tt,fe,je,z,ki,qn,Un,Hn,zi,Ai,Wn,Yn,Zn,Kn;class Jr{constructor(e,t){y(this,z);y(this,pe);y(this,tt);y(this,fe,new Set);y(this,je);w(this,je,t),w(this,pe,It("#editor-panel").show()),w(this,tt,new Xr({onClick:()=>{r(this,z,Wn).call(this)}})),n(this,tt).visible=!1,n(this,pe).append(n(this,tt).container),e.on(he.TYPE,i=>{n(this,fe).clear(),i.features.forEach(s=>{n(this,fe).add(s)}),r(this,z,ki).call(this,i.features,!0)}),e.on(ke.TYPE,i=>{n(this,fe).size||r(this,z,ki).call(this,i.feature?[i.feature]:[],!1)})}getContainer(){return n(this,pe)}}pe=new WeakMap,tt=new WeakMap,fe=new WeakMap,je=new WeakMap,z=new WeakSet,ki=function(e,t){r(this,z,qn).call(this),e.length===1?r(this,z,Un).call(this,e[0],t):r(this,z,Hn).call(this,e)},qn=function(){n(this,tt).disabled=!0,r(this,z,zi).call(this,null)},Un=function(e,t){var s;const i=((s=e.dataObject)==null?void 0:s.type)??r(this,z,Ai).call(this,e);n(this,tt).disabled=!t,r(this,z,zi).call(this,i),i.properties.forEach(l=>{var h,u;if(r(this,z,Yn).call(this,l),l.isUnique){const c=(h=e.dataObject)==null?void 0:h.getPropertyValue(l.label);c!==null&&r(this,z,Zn).call(this,l,c)}else{const c=((u=e.dataObject)==null?void 0:u.getPropertyValues(l.label))??[];r(this,z,Kn).call(this,l,c)}})},Hn=function(e){const t=e.map(i=>{var s;return((s=i.dataObject)==null?void 0:s.type)??r(this,z,Ai).call(this,i)});n(this,tt).disabled=!0,n(this,tt).visible=!!e.length,n(this,tt).setFeatureTypes(t),e.length},zi=function(e){n(this,tt).visible=!!e,n(this,tt).setFeatureType(e)},Ai=function(e){return n(this,je).call(this,e.geometry.type.toLowerCase(),"ObjectType")},Wn=function(){console.log("type button clicked")},Yn=function(e){console.log("create field for",e.fullName)},Zn=function(e,t){console.log("set field value for",e.fullName,"to",t)},Kn=function(e,t){console.log("set field values for",e.fullName,"to",t)};var Xt,xt,Nt,$,O,Di,C;class Qr{constructor(e,t){y(this,O);y(this,Xt);y(this,xt);y(this,Nt);y(this,$);w(this,Xt,e),w(this,Nt,kn("map-editor-context-menu-container")),w(this,$,{move:B({title:t.moveTitle??"Move",icon:q("cursor-move"),onClick:()=>{r(this,O,C).call(this,t.onMove)},shortcut:["M"]}),copy:B({title:t.copyTitle??"Copy",icon:q("content-copy"),onClick:()=>{r(this,O,C).call(this,t.onCopy)},shortcut:["Ctrl","C"]}),paste:B({title:t.pasteTitle??"Paste",icon:q("content-paste"),onClick:()=>{r(this,O,C).call(this,t.onPaste)},shortcut:["Ctrl","V"]}),delete:B({title:t.deleteTitle??"Delete",icon:q("trash-can-outline"),onClick:()=>{r(this,O,C).call(this,t.onDelete)},shortcut:["Ctrl","Backspace"]}),continueLine:B({title:t.continueLineTitle??"Continue Line",icon:q("ray-start-arrow"),onClick:()=>{r(this,O,C).call(this,t.onContinueLine)},shortcut:["A"]}),disconnect:B({title:t.disconnectTitle??"Disconnect",icon:q("pan-horizontal"),onClick:()=>{r(this,O,C).call(this,t.onDisconnect)},shortcut:["D"]}),extractPoint:B({title:t.extractPointTitle??"Extract Point",icon:q("pan-top-right"),onClick:()=>{r(this,O,C).call(this,t.onExtractPoint)},shortcut:["E"]}),split:B({title:t.splitTitle??"Split",icon:q("content-cut"),onClick:()=>{r(this,O,C).call(this,t.onSplit)},shortcut:["X"]}),circularize:B({title:t.circularizeTitle??"Circularize",icon:q("vector-circle"),onClick:()=>{r(this,O,C).call(this,t.onCircularize)},shortcut:["O"]}),square:B({title:t.squareTitle??"Square",icon:q("vector-square"),onClick:()=>{r(this,O,C).call(this,t.onSquare)},shortcut:["Q"]}),flipLong:B({title:t.flipLongTitle??"Flip Long",icon:q("dock-top"),onClick:()=>{r(this,O,C).call(this,t.onFlipLong)},shortcut:["T"]}),flipShort:B({title:t.flipShortTitle??"Flip Short",icon:q("dock-left"),onClick:()=>{r(this,O,C).call(this,t.onFlipShort)},shortcut:["Y"]}),reverseLine:B({title:t.reverseLineTitle??"Reverse Line",icon:q("chevron-double-left"),onClick:()=>{r(this,O,C).call(this,t.onReverseLine)},shortcut:["V"]}),rotate:B({title:t.rotateTitle??"Rotate",icon:q("backup-restore"),onClick:()=>{r(this,O,C).call(this,t.onRotate)},shortcut:["R"]}),straightenLine:B({title:t.straightenLineTitle??"Straighten Line",icon:q("ray-start-vertex-end"),onClick:()=>{r(this,O,C).call(this,t.onStraightenLine)},shortcut:["S"]})}),It("body").on("keydown",i=>{if(!(n(this,Xt)instanceof zn&&n(this,Xt).textFieldHasFocus))switch(i.key){case"v":i.ctrlKey?r(this,O,C).call(this,t.onPaste):r(this,O,C).call(this,t.onReverseLine);break;case"c":i.ctrlKey&&r(this,O,C).call(this,t.onCopy);break;case"m":r(this,O,C).call(this,t.onMove);break;case"Backspace":i.ctrlKey&&r(this,O,C).call(this,t.onDelete);break;case"a":r(this,O,C).call(this,t.onContinueLine);break;case"d":r(this,O,C).call(this,t.onDisconnect);break;case"e":r(this,O,C).call(this,t.onExtractPoint);break;case"x":r(this,O,C).call(this,t.onSplit);break;case"o":r(this,O,C).call(this,t.onCircularize);break;case"q":r(this,O,C).call(this,t.onSquare);break;case"t":r(this,O,C).call(this,t.onFlipLong);break;case"y":r(this,O,C).call(this,t.onFlipShort);break;case"r":r(this,O,C).call(this,t.onRotate);break;case"s":r(this,O,C).call(this,t.onStraightenLine);break}}),n(this,Nt).append(n(this,$).move,n(this,$).continueLine,n(this,$).disconnect,n(this,$).split,n(this,$).circularize,n(this,$).square,n(this,$).flipLong,n(this,$).flipShort,n(this,$).reverseLine,n(this,$).rotate,n(this,$).straightenLine,n(this,$).copy,n(this,$).paste,n(this,$).delete),w(this,xt,new me.Popup().setDOMContent(n(this,Nt))),n(this,xt)._closeButton.style.display="none"}show(e,t={}){n(this,Nt).style.display="block";let i=!1;for(const[s,l]of Object.entries(n(this,$))){const h=t[s];r(this,O,Di).call(this,l,!!h),h&&(i=!0)}i&&(n(this,xt).setLngLat(e).addTo(n(this,Xt)),n(this,xt).addClassName("map-editor-context-menu"))}hide(){n(this,xt).remove(),n(this,Nt).style.display="none";for(const e of Object.values(n(this,$)))r(this,O,Di).call(this,e,!1)}isVisible(){return n(this,xt).isOpen()}}Xt=new WeakMap,xt=new WeakMap,Nt=new WeakMap,$=new WeakMap,O=new WeakSet,Di=function(e,t){e.style.display=t?"block":"none",e.disabled=!t},C=function(e){e(),this.hide()};var Xn=(a=>(a.POINT="point",a.LINE="linestring",a.POLYGON="polygon",a.DRAW="draw",a.GRAB="grab",a.GRABBING="grabbing",a.CONNECT_VERTEX="draw-connect-vertex",a.CONNECT_LINE="draw-connect-line",a))(Xn||{}),gi,yi,mi,wi,vi,Lt,v,Jt,Ge,Qt,_t,Tt,rt,ge,x,F,P,k,_,ot,G,Rt,K,te,Be,Ot,bi,o,ne,xe,St,ut,Jn,Qn,ts,_i,se,es,ni,Ri,Le,is,si,$i,ns,ji,re,Vt,Te,vt,ye,ss,rs,j,Gi,os,Bi,qi,as,Ui,Hi,ls,hs,cs,Wi,Yi,Zi,Ki,us,ds,ps,fs,Xi,Ji,kt,ri,Oe,gs,oe,Yt,Fe,Qi,ys,ms,ws,vs,bs,tn,en,nn,Es,Ps,Ss,xs,Ls,Ts,Os,Fs,Cs,Is,Ms,Vs,ks,zs,sn,As,Ds,Ns,_s,Rs,V;const I=class I{constructor(e,t){y(this,o);y(this,v);y(this,Jt);y(this,Ge);y(this,Qt);y(this,_t);y(this,Tt);y(this,rt,new Map);y(this,ge,new Map);y(this,x,new Set);y(this,F,null);y(this,P,"view_only");y(this,k,null);y(this,_,null);y(this,ot,[]);y(this,G,null);y(this,Rt,!0);y(this,K,null);y(this,te,[]);y(this,Be,null);y(this,Ot,{units:{},enums:{},objects:{}});y(this,bi,0);n(this,Ot).units={...t.units},n(this,Ot).enums={...t.enums},n(this,Ot).objects={...t.objects},w(this,v,e),w(this,Jt,It(n(this,v).getCanvasContainer())),w(this,Ge,new Jr(n(this,v),(h,u)=>r(this,o,ne).call(this,h,u))),w(this,Qt,new Qr(n(this,v),{onMove:()=>{r(this,o,ys).call(this)},moveTitle:window.ottm.translate("map.context_menu.move.tooltip"),onCopy:()=>{r(this,o,ws).call(this)},copyTitle:window.ottm.translate("map.context_menu.copy.tooltip"),onPaste:()=>{r(this,o,bs).call(this)},pasteTitle:window.ottm.translate("map.context_menu.paste.tooltip"),onDelete:()=>{r(this,o,en).call(this)},deleteTitle:window.ottm.translate("map.context_menu.delete.tooltip"),onContinueLine:()=>{r(this,o,Es).call(this)},continueLineTitle:window.ottm.translate("map.context_menu.continue_line.tooltip"),onDisconnect:()=>{r(this,o,Ss).call(this)},disconnectTitle:window.ottm.translate("map.context_menu.disconnect.tooltip"),onExtractPoint:()=>{r(this,o,Ls).call(this)},extractPointTitle:window.ottm.translate("map.context_menu.extract_point.tooltip"),onSplit:()=>{r(this,o,Os).call(this)},splitTitle:window.ottm.translate("map.context_menu.split.tooltip"),onCircularize:()=>{r(this,o,Cs).call(this)},circularizeTitle:window.ottm.translate("map.context_menu.circularize.tooltip"),onSquare:()=>{r(this,o,Ms).call(this)},squareTitle:window.ottm.translate("map.context_menu.square.tooltip"),onFlipLong:()=>{r(this,o,ks).call(this)},flipLongTitle:window.ottm.translate("map.context_menu.flip_long.tooltip"),onFlipShort:()=>{r(this,o,zs).call(this)},flipShortTitle:window.ottm.translate("map.context_menu.flip_short.tooltip"),onReverseLine:()=>{r(this,o,As).call(this)},reverseLineTitle:window.ottm.translate("map.context_menu.reverse_line.tooltip"),onRotate:()=>{r(this,o,Ns).call(this)},rotateTitle:window.ottm.translate("map.context_menu.rotate.tooltip"),onStraightenLine:()=>{r(this,o,Rs).call(this)},straightenLineTitle:window.ottm.translate("map.context_menu.straighten_line.tooltip")})),w(this,Tt,new Zr({onDrawPoint:()=>{n(this,P)==="draw_point"?r(this,o,ni).call(this):r(this,o,es).call(this)},onDrawLine:()=>{n(this,P)==="draw_line"?r(this,o,Le).call(this):r(this,o,Ri).call(this)},onDrawPolygon:()=>{n(this,P)==="draw_polygon"?r(this,o,si).call(this):r(this,o,is).call(this)},drawPointButtonTitle:window.ottm.translate("map.controls.edit.draw_point.tooltip"),drawLineButtonTitle:window.ottm.translate("map.controls.edit.draw_line.tooltip"),drawPolygonButtonTitle:window.ottm.translate("map.controls.edit.draw_polygon.tooltip")})),n(this,v).addControl(n(this,Tt),"top-left"),n(this,v).dragRotate.disable(),n(this,v).on("click",h=>{r(this,o,ls).call(this,h)}),n(this,v).on("dblclick",h=>{r(this,o,ds).call(this,h)}),n(this,v).on("mousemove",h=>{r(this,o,Gi).call(this,h)}),n(this,v).on("touchmove",h=>{h.points.length===1&&r(this,o,Gi).call(this,h)}),n(this,v).on("mousedown",h=>{r(this,o,Ui).call(this,h)}),n(this,v).on("touchstart",h=>{h.points.length===1&&r(this,o,Ui).call(this,h)}),n(this,v).on("mouseup",h=>{r(this,o,Hi).call(this,h)}),n(this,v).on("touchend",h=>{h.points.length===1&&r(this,o,Hi).call(this,h)}),n(this,v).on("controls.styles.tiles_changed",()=>{n(this,v).getLayersOrder().length&&n(this,v).moveLayer("tiles",n(this,v).getLayersOrder()[0])}),n(this,v).on("zoomstart",()=>{r(this,o,fs).call(this)}),n(this,v).on("zoomend",()=>{r(this,o,Xi).call(this)}),n(this,v).on("load",()=>{r(this,o,Xi).call(this)}),It("body").on("keydown",h=>{h.originalEvent&&(!(n(this,v)instanceof zn)||!n(this,v).textFieldHasFocus)&&r(this,o,ps).call(this,h.originalEvent)});const i=n(this,Jt).parent();i.addClass("split");const s=n(this,Ge).getContainer();s.addClass("split"),cr([s[0],i[0]],{sizes:[20,80],minSize:[0,100],gutterSize:5});const l=window.ottm.translate("map.edit_zoom_notice");w(this,_t,It(`
<div id="edit-zoom-notice-panel">
  <span class="mdi mdi-plus"></span> ${l}
</div>
`)),n(this,_t).on("click",()=>{n(this,v).easeTo({zoom:n(I,Lt)})}),i.append(n(this,_t))}createFeature(e){const t=l=>l.map(h=>{const u=n(this,ge).get(h);if(!u)throw new Error(`No point with ID ${h}`);return u}),i=(l,h)=>r(this,o,ne).call(this,l,h),s=r(this,o,xe).call(this);if(e.type==="Point"){const l=new me.LngLat(e.lng,e.lat);r(this,o,St).call(this,new N(s,i,l,e.dbId,e.layer,e.dataObject))}else if(e.type==="LineString"){const l=t(e.verticesDbIds);r(this,o,St).call(this,new A(s,i,l,e.dbId,e.layer,e.dataObject))}else{const l=e.verticesDbIds.map(h=>t(h));r(this,o,St).call(this,new Q(s,i,l,e.dbId,e.layer,e.dataObject))}}};gi=new WeakMap,yi=new WeakMap,mi=new WeakMap,wi=new WeakMap,vi=new WeakMap,Lt=new WeakMap,v=new WeakMap,Jt=new WeakMap,Ge=new WeakMap,Qt=new WeakMap,_t=new WeakMap,Tt=new WeakMap,rt=new WeakMap,ge=new WeakMap,x=new WeakMap,F=new WeakMap,P=new WeakMap,k=new WeakMap,_=new WeakMap,ot=new WeakMap,G=new WeakMap,Rt=new WeakMap,K=new WeakMap,te=new WeakMap,Be=new WeakMap,Ot=new WeakMap,bi=new WeakMap,o=new WeakSet,ne=function(e,t){switch(t){case"UnitType":return n(this,Ot).units[e];case"Enum":return n(this,Ot).enums[e];case"ObjectType":return n(this,Ot).objects[e];default:throw new Error(`Invalid value "${t}"`)}},xe=function(){return(yn(this,bi)._++).toString()},St=function(e){e.id&&n(this,rt).get(e.id)||(n(this,rt).set(e.id,e),e instanceof N?e.dbId&&n(this,ge).set(e.dbId,e):e instanceof A?e.vertices.forEach(t=>{r(this,o,St).call(this,t)}):e instanceof Q&&e.vertices.flatMap(t=>t).forEach(t=>{r(this,o,St).call(this,t)}),n(this,v).addSource(e.id,{type:"geojson",data:e}),r(this,o,ss).call(this,e),e instanceof A?e.vertices.forEach(t=>{r(this,o,Vt).call(this,t.id),r(this,o,V).call(this,t)}):e instanceof Q&&e.vertices.flatMap(t=>t).forEach(t=>{r(this,o,Vt).call(this,t.id),r(this,o,V).call(this,t)}))},ut=function(e){var i,s;const t=n(this,rt).get(e);t&&((i=r(this,o,Te).call(this,e))==null||i.forEach(l=>{n(this,v).removeLayer(l)}),n(this,rt).delete(e),t instanceof N?(t.dbId&&n(this,ge).delete(t.dbId),r(this,o,Jn).call(this,t)):t instanceof A?r(this,o,Qn).call(this,t):t instanceof Q&&r(this,o,ts).call(this,t),n(this,v).removeSource(e),n(this,x).delete(t),((s=n(this,F))==null?void 0:s.id)===e&&w(this,F,null))},Jn=function(e){e.boundFeatures.forEach(t=>{e.unbindFeature(t);const i=t.removeVertex(e);let s=!1;i.type==="delete_feature"?(r(this,o,ut).call(this,t.id),s=!0):i.type==="delete_ring"&&(t.deleteRing(i.ringIndex),i.points.forEach(l=>{l.boundFeatures.length===0&&r(this,o,ut).call(this,l.id)})),s||r(this,o,V).call(this,t)})},Qn=function(e){r(this,o,_i).call(this,e,e.vertices)},ts=function(e){e.vertices.forEach(t=>{r(this,o,_i).call(this,e,t)})},_i=function(e,t){t.forEach(i=>{i.unbindFeature(e),i.boundFeatures.length===0?r(this,o,ut).call(this,i.id):r(this,o,V).call(this,i)})},se=function(e){switch(n(this,P)){case"view_only":case"select":r(this,o,Yt).call(this,e);break;case"draw_point":r(this,o,ni).call(this,e);break;case"draw_line":r(this,o,Le).call(this,e);break;case"draw_polygon":r(this,o,si).call(this,e);break;case"move_features":r(this,o,ns).call(this);break}},es=function(){n(this,P)!=="view_only"&&(r(this,o,se).call(this),w(this,P,"draw_point"),r(this,o,j).call(this,"draw"))},ni=function(e){w(this,P,"select"),r(this,o,Yt).call(this,e),n(this,Tt).deactivateButton(0)},Ri=function(e,t){n(this,P)!=="view_only"&&(r(this,o,se).call(this),w(this,P,"draw_line"),e&&t&&e.isEndVertex(t)?(w(this,G,e),w(this,k,r(this,o,Fe).call(this,t.lngLat)),w(this,Rt,e.vertices.indexOf(t)!==0),n(this,Rt)?n(this,G).appendVertex(n(this,k),n(this,G).getNextVertexPath()):n(this,G).appendVertex(n(this,k),"0"),r(this,o,V).call(this,n(this,G))):(w(this,G,new A(r(this,o,xe).call(this),(i,s)=>r(this,o,ne).call(this,i,s))),r(this,o,St).call(this,n(this,G))),r(this,o,j).call(this,"draw"))},Le=function(e){n(this,G)&&(r(this,o,$i).call(this,n(this,G),1,e),w(this,G,null))},is=function(){n(this,P)!=="view_only"&&(r(this,o,se).call(this),w(this,P,"draw_polygon"),w(this,K,new Q(r(this,o,xe).call(this),(e,t)=>r(this,o,ne).call(this,e,t))),r(this,o,St).call(this,n(this,K)),r(this,o,j).call(this,"draw"))},si=function(e){n(this,K)&&(r(this,o,$i).call(this,n(this,K),2,e,()=>{var t;(t=n(this,K))==null||t.lockRing(0)}),w(this,K,null))},$i=function(e,t,i,s){w(this,P,"select");let l=null;n(this,k)&&(l=e.removeVertex(n(this,k)),r(this,o,ut).call(this,n(this,k).id),w(this,k,null)),(l==null?void 0:l.type)==="delete_feature"?(r(this,o,ut).call(this,e.id),n(this,te).forEach(h=>{r(this,o,ut).call(this,h.id)})):e.isEmpty()?r(this,o,ut).call(this,e.id):(s==null||s(),r(this,o,V).call(this,e),r(this,o,Oe).call(this,e,!1)),n(this,te).splice(0),r(this,o,Yt).call(this,i),n(this,Tt).deactivateButton(t)},ns=function(){w(this,P,"select");const e=new Set;n(this,ot).forEach(({point:t,startPos:i})=>{t.lngLat=i,r(this,o,V).call(this,t),t.boundFeatures.forEach(s=>{e.add(s)})}),e.forEach(t=>{r(this,o,V).call(this,t)}),n(this,ot).splice(0)},ji=function(e){const t=n(this,v).getLayersOrder();let i=1/0,s=null;for(const l of r(this,o,re).call(this,e)){const h=t.indexOf(l);if(h===-1)continue;const u=n(this,rt).get(l),c=u instanceof N,p=!(s instanceof N);(!s||c&&(p||h>i)||!c&&p&&h<i)&&(i=h,s=u??null)}return s},re=function(e,t){const i=n(this,v).queryRenderedFeatures(e).filter(s=>!(t!=null&&t.has(s.source))).map(s=>s.source);return[...new Set(i)]},Vt=function(e,t){var i,s,l;if(t){const h=(i=r(this,o,Te).call(this,t))==null?void 0:i[0];(s=r(this,o,Te).call(this,e))==null||s.forEach(u=>{n(this,v).moveLayer(u,h)})}else(l=r(this,o,Te).call(this,e))==null||l.forEach(h=>{n(this,v).moveLayer(h)})},Te=function(e){const t=n(this,rt).get(e);return t instanceof N?[t.id+"-highlight",t.id]:t instanceof A?[t.id+"-highlight",t.id,t.id+"-foreground"]:t instanceof Q?[t.id,t.id+"-highlight",t.id+"-border"]:null},vt=new WeakMap,ye=new WeakMap,ss=function(e){if(e instanceof N)n(this,v).addLayer({id:e.id+"-highlight",type:"circle",source:e.id,paint:{"circle-radius":["+",["get","radius"],4],"circle-color":n(I,ye)},filter:n(I,vt)}),n(this,v).addLayer({id:e.id,type:"circle",source:e.id,paint:{"circle-radius":["get","radius"],"circle-color":["get","color"],"circle-stroke-width":1,"circle-stroke-color":n(I,wi)},filter:n(I,vt)});else if(e instanceof A)n(this,v).addLayer({id:e.id+"-highlight",type:"line",source:e.id,layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["+",["get","width"],8],"line-color":n(I,ye)},filter:n(I,vt)}),n(this,v).addLayer({id:e.id,type:"line",source:e.id,layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":["get","width"],"line-color":["step",["zoom"],n(I,vi),n(I,Lt),["get","color"]]}}),n(this,v).addLayer({id:e.id+"-foreground",type:"line",source:e.id,layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":["get","fgWidth"],"line-color":["get","fgColor"]},filter:n(I,vt)});else if(e instanceof Q)n(this,v).addLayer({id:e.id,type:"fill",source:e.id,paint:{"fill-color":["concat",["get","color"],"30"]},filter:n(I,vt)}),n(this,v).addLayer({id:e.id+"-highlight",type:"line",source:e.id,layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":8,"line-color":n(I,ye)},filter:n(I,vt)}),n(this,v).addLayer({id:e.id+"-border",type:"line",source:e.id,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["get","color"]},filter:n(I,vt)});else throw TypeError(`Unexpected type: ${e}`);r(this,o,rs).call(this,e)},rs=function(e){e instanceof A&&(n(this,v).setPaintProperty(e.id,"line-dasharray",e.properties.dash),n(this,v).setPaintProperty(e.id+"-foreground","line-dasharray",e.properties.fgDash))},j=function(e){n(this,Jt).addClass(`cursor-${e}`);for(const t of Object.values(Xn))t!==e&&n(this,Jt).removeClass(`cursor-${t}`)},Gi=function(e){if(w(this,Be,e.lngLat),n(this,P)==="view_only")return;if(n(this,P)==="move_features"){r(this,o,as).call(this,e);return}const t=r(this,o,ji).call(this,e.point);t?n(this,k)||r(this,o,kt).call(this,t):r(this,o,ri).call(this),n(this,k)?r(this,o,os).call(this,e):r(this,o,Yt).call(this)},os=function(e){const t=n(this,k);if(!t)return;r(this,o,oe).call(this),r(this,o,j).call(this,"draw");const i=new Set;t.boundFeatures.forEach(h=>{if(i.add(h.id),h instanceof A){const u=(h.vertices.length-1).toString();!h.isLoop()&&h.getVertexPath(t)==="0"?h.vertices.filter(c=>h.getVertexPath(c)!==u).forEach(c=>{i.add(c.id)}):!h.isLoop()&&h.getVertexPath(t)===u?h.vertices.slice(1).forEach(c=>{i.add(c.id)}):h.vertices.forEach(c=>{i.add(c.id)})}else h instanceof Q&&h.vertices.flatMap(u=>u).forEach(u=>{i.add(u.id)})}),i.add(t.id);const s=r(this,o,re).call(this,void 0,i).map(h=>{const u=n(this,rt).get(h);if(!u)throw new Error(`Missing feature with ID ${h}`);return u}),l=Vn(e.lngLat,s,n(this,v).getZoom());if(w(this,_,null),l)if(l.type==="point"||l.type==="segment_vertex"){let h;if(l.type==="point")h=l.point;else{const{feature:c,path:p}=l,g=c.getVertex(p);if(!g)throw new Error(`Invalid path "${p}"`);h=g}h.boundFeatures.every(c=>{const p=c.getVertexPath(h);if(!p)throw new Error(`Point #${h.id} does not belong to feature #${c.id}`);return c.canAcceptVertex(t,p)})&&(w(this,_,l),t.onDrag(h.lngLat),r(this,o,kt).call(this,h),r(this,o,j).call(this,"draw-connect-vertex"))}else{const{feature:h,path:u,lngLat:c}=l;let p=h.canInsertVertex(t,u),g,T;if(p){const M=h.getSegmentVertices(u);if(!M)throw new Error(`Invalid path "${u}"`);[g,T]=M;for(const D of i){const Y=n(this,rt).get(D);if(Et(Y)&&Y.getSegmentPath(g,T)){p=!1;break}}}if(p){const M=[];s.forEach(D=>{if(Et(D)&&D!==h){const Y=D.getSegmentPath(g,T);Y&&M.push({feature:D,path:Y})}}),w(this,_,l),M.length&&(n(this,_).featuresWithSameSegment=M),t.onDrag(c),r(this,o,kt).call(this,h),r(this,o,j).call(this,"draw-connect-line")}}n(this,_)||(r(this,o,ri).call(this),t.onDrag(e.lngLat),(n(this,P)==="draw_line"&&r(this,o,Bi).call(this,e.point)[0]||n(this,P)==="draw_polygon"&&r(this,o,qi).call(this,e.point)[0])&&r(this,o,j).call(this,"draw-connect-vertex")),r(this,o,V).call(this,t),t.boundFeatures.forEach(h=>{r(this,o,V).call(this,h)})},Bi=function(e){if(!n(this,G))return[!1,null];const t=n(this,G).vertices.length;if(t<=2)return[!1,null];const i=r(this,o,re).call(this,e),s=n(this,Rt)?n(this,G).getVertex((t-2).toString()):n(this,G).getVertex("1");return s?[i.some(l=>l===s.id),s]:[!1,null]},qi=function(e){if(!n(this,K))return[!1,null];const t=n(this,K).vertices;if(t.length===0)return[!1,null];const i=t[0];if(i.length<3)return[!1,null];const s=r(this,o,re).call(this,e),l=n(this,K).getVertex(`0.${i.length-2}`);return l?[s.some(h=>h===l.id),l]:[!1,null]},as=function(e){r(this,o,j).call(this,"grabbing");const t=new Set;n(this,ot).forEach(({point:i,offset:s})=>{i.onDrag(e.lngLat,s),r(this,o,V).call(this,i),i.boundFeatures.forEach(l=>{t.add(l)})}),t.forEach(i=>{r(this,o,V).call(this,i)})},Ui=function(e){if(n(this,P)==="select"){if(e.type==="mousedown"&&wr(e.originalEvent)){r(this,o,hs).call(this,e);return}n(this,F)instanceof N?(e.preventDefault(),w(this,k,n(this,F)),r(this,o,Vt).call(this,n(this,k).id)):r(this,o,j).call(this,"grabbing")}n(this,Qt).isVisible()&&n(this,Qt).hide()},Hi=function(e){if(n(this,P)!=="select")return;const t=n(this,k),i=n(this,_);if(i&&t){if(i.type==="point"||i.type==="segment_vertex"){const s=r(this,o,Zi).call(this);if(!s)return;t.onDrag(s.lngLat),s.dataObject&&!t.dataObject&&t.copyDataOf(s),s.boundFeatures.forEach(l=>{l.replaceVertex(t,s)}),r(this,o,ut).call(this,s.id)}else r(this,o,Ki).call(this);t.boundFeatures.forEach(s=>{r(this,o,V).call(this,s)}),r(this,o,V).call(this,t),r(this,o,Vt).call(this,t.id),w(this,_,null)}t&&(r(this,o,kt).call(this,t),w(this,k,null)),r(this,o,Yt).call(this,e.point)},ls=function(e){switch(n(this,P)){case"draw_point":r(this,o,cs).call(this,e);break;case"draw_line":n(this,G)&&r(this,o,Wi).call(this,n(this,G),e);break;case"draw_polygon":n(this,K)&&r(this,o,Wi).call(this,n(this,K),e);break;case"move_features":r(this,o,us).call(this,e);break;case"select":if(n(this,F)){const t=e.originalEvent.ctrlKey;t&&n(this,x).has(n(this,F))?r(this,o,gs).call(this,n(this,F)):r(this,o,Oe).call(this,n(this,F),t)}else r(this,o,oe).call(this);break;case"view_only":r(this,o,oe).call(this);break}},hs=function(e){const t={};if(n(this,F)){n(this,F).selectionMode!==gt.SELECTED&&r(this,o,Oe).call(this,n(this,F),!1),t.move=r(this,o,Qi).call(this).length!==0,t.copy=r(this,o,ms).call(this).length!==0,t.delete=r(this,o,tn).call(this).length!==0,t.continueLine=r(this,o,nn).call(this)!==null,t.disconnect=r(this,o,Ps).call(this).length!==0,t.extractPoint=r(this,o,xs).call(this).length!==0,t.split=r(this,o,Ts).call(this).length!==0,t.circularize=r(this,o,Fs).call(this).length!==0,t.square=r(this,o,Is).call(this).length!==0;const i=r(this,o,Vs).call(this).length!==0;t.flipLong=i,t.flipShort=i,t.reverseLine=r(this,o,sn).call(this).length!==0,t.rotate=r(this,o,Ds).call(this).length!==0,t.straightenLine=r(this,o,_s).call(this).length!==0}else t.paste=r(this,o,vs).call(this).length!==0,r(this,o,oe).call(this);n(this,Qt).show(e.lngLat,t)},cs=function(e){r(this,o,Oe).call(this,r(this,o,Yi).call(this,e),!1),r(this,o,ni).call(this,e.point),r(this,o,j).call(this,"point")},Wi=function(e,t){if(n(this,_)&&n(this,k)){if(n(this,_).type==="point"||n(this,_).type==="segment_vertex"){const l=r(this,o,Zi).call(this);if(!l)return;const h=e instanceof A&&e.isEndVertex(l);if(e.replaceVertex(l,n(this,k)),r(this,o,ut).call(this,n(this,k).id),r(this,o,Vt).call(this,l.id),w(this,k,null),h){r(this,o,V).call(this,l),r(this,o,kt).call(this,l),r(this,o,j).call(this,"point"),r(this,o,Le).call(this,t.point),w(this,_,null);return}}else r(this,o,Ki).call(this),n(this,te).push(n(this,k));w(this,_,null)}else{const[l,h]=e instanceof A?r(this,o,Bi).call(this,t.point):r(this,o,qi).call(this,t.point);if(l&&h){r(this,o,kt).call(this,h),r(this,o,j).call(this,"point"),e instanceof A?r(this,o,Le).call(this,t.point):r(this,o,si).call(this,t.point);return}if(!n(this,k)){const u=r(this,o,Yi).call(this,t);u!==n(this,F)&&n(this,te).push(u),e instanceof A&&!n(this,Rt)?e.appendVertex(u,"0"):e.appendVertex(u,e.getNextVertexPath()),r(this,o,V).call(this,u)}}const i=n(this,k),s=r(this,o,Fe).call(this,t.lngLat);e instanceof A&&!n(this,Rt)?e.appendVertex(s,"0"):e.appendVertex(s,e.getNextVertexPath()),w(this,k,s),i&&r(this,o,V).call(this,i),r(this,o,V).call(this,e),(e instanceof A&&e.vertices.length>2||e instanceof Q&&e.vertices[0].length>3)&&r(this,o,j).call(this,"draw-connect-vertex")},Yi=function(e){let t;return n(this,F)instanceof N?t=n(this,F):(t=r(this,o,Ji).call(this,e))||(t=r(this,o,Fe).call(this,e.lngLat)),r(this,o,Vt).call(this,t.id),t},Zi=function(){var e,t;if(((e=n(this,_))==null?void 0:e.type)==="point")return n(this,_).point;if(((t=n(this,_))==null?void 0:t.type)==="segment_vertex"){const{feature:i,path:s}=n(this,_);return i.getVertex(s)}return null},Ki=function(){var t,i;const e=n(this,k);if(((t=n(this,_))==null?void 0:t.type)==="segment"&&e){const{feature:s,path:l,lngLat:h}=n(this,_);e.onDrag(h),s.insertVertexAfter(e,l),(i=n(this,_).featuresWithSameSegment)==null||i.forEach(({feature:u,path:c})=>{u.insertVertexAfter(e,c)}),r(this,o,Vt).call(this,e.id)}},us=function(e){w(this,P,"select"),n(this,ot).splice(0),r(this,o,Yt).call(this,e.point)},ds=function(e){if(Et(n(this,F))){const t=r(this,o,Ji).call(this,e);t&&(r(this,o,kt).call(this,t),r(this,o,j).call(this,"point"))}},ps=function(e){n(this,P)==="select"?e.key==="Delete"&&r(this,o,en).call(this):e.key==="Escape"&&r(this,o,se).call(this)},fs=function(){n(this,k)?n(this,v).setMinZoom(n(I,Lt)):n(this,v).setMinZoom(0)},Xi=function(){const e=n(this,v).getZoom();if(e<n(I,Lt)&&n(this,P)!=="view_only"){r(this,o,se).call(this),w(this,P,"view_only"),r(this,o,ri).call(this),r(this,o,j).call(this,"grab");for(let t=0;t<3;t++)n(this,Tt).setButtonDisabled(t,!0);n(this,_t).show()}else if(e>=n(I,Lt)&&n(this,P)==="view_only"){w(this,P,"select");for(let t=0;t<3;t++)n(this,Tt).setButtonDisabled(t,!1);n(this,_t).hide()}},Ji=function(e){if(Et(n(this,F))){const t=r(this,o,re).call(this,e.point).map(s=>n(this,rt).get(s)).filter(s=>Et(s)),i=Vn(e.lngLat,t,n(this,v).getZoom());if((i==null?void 0:i.type)==="segment"){const{feature:s,path:l,lngLat:h}=i,u=r(this,o,Fe).call(this,h),c=s.getSegmentVertices(l);if(!c)throw new Error(`Invalid path ${l}`);const[p,g]=c,T=(M,D)=>{M.insertVertexAfter(u,D),r(this,o,V).call(this,M)};return T(s,l),t.forEach(M=>{if(Et(M)&&M!==s){const D=M.getSegmentPath(p,g);D&&T(M,D)}}),r(this,o,V).call(this,u),u}}return null},kt=function(e){n(this,F)!==e&&(n(this,F)&&!n(this,x).has(n(this,F))&&(n(this,F).selectionMode=gt.NONE,r(this,o,V).call(this,n(this,F))),w(this,F,e),n(this,x).has(n(this,F))||(n(this,F).selectionMode=gt.HOVERED,r(this,o,V).call(this,n(this,F))),n(this,v).fire(new ke(n(this,F))))},ri=function(){n(this,F)&&(n(this,x).has(n(this,F))||(n(this,F).selectionMode=gt.NONE,r(this,o,V).call(this,n(this,F))),w(this,F,null),n(this,v).fire(new ke))},Oe=function(e,t){let i=!1;n(this,x).size&&!t&&(r(this,o,oe).call(this,!1),i=!0),n(this,x).has(e)||(n(this,x).add(e),e.selectionMode=gt.SELECTED,r(this,o,V).call(this,e),i=!0),i&&n(this,v).fire(new he([...n(this,x)]))},gs=function(e){n(this,x).delete(e)&&(e.selectionMode=gt.NONE,r(this,o,V).call(this,e),n(this,v).fire(new he([...n(this,x)])))},oe=function(e=!0){n(this,x).size&&(n(this,x).forEach(t=>{t.selectionMode=gt.NONE,r(this,o,V).call(this,t)}),n(this,x).clear(),e&&n(this,v).fire(new he))},Yt=function(e){if(n(this,P)==="select"){const t=e?r(this,o,ji).call(this,e):n(this,F);if(t){const i={Point:"point",LineString:"linestring",Polygon:"polygon"}[t.geometry.type];r(this,o,j).call(this,i)}else r(this,o,j).call(this,"grab")}},Fe=function(e){const t=new N(r(this,o,xe).call(this),(i,s)=>r(this,o,ne).call(this,i,s),e);return r(this,o,St).call(this,t),t},Qi=function(){return n(this,P)!=="select"?[]:[...n(this,x)].filter(e=>!(e instanceof N)||!e.boundFeatures.some(t=>n(this,x).has(t)))},ys=function(){const e=n(this,Be);if(!e)return;n(this,ot).splice(0);const t=new Set;r(this,o,Qi).call(this).forEach(i=>{i instanceof N?(t.add(i),n(this,ot).push({point:i,offset:le.sub(i.lngLat,e),startPos:i.lngLat})):i instanceof A?i.vertices.forEach(s=>{t.has(s)||(t.add(s),n(this,ot).push({point:s,offset:le.sub(s.lngLat,e),startPos:s.lngLat}))}):i instanceof Q&&i.vertices.flatMap(s=>s).forEach(s=>{t.has(s)||(t.add(s),n(this,ot).push({point:s,offset:le.sub(s.lngLat,e),startPos:s.lngLat}))})}),n(this,ot).length&&(w(this,P,"move_features"),r(this,o,j).call(this,"grabbing"))},ms=function(){return n(this,P)==="select"?[...n(this,x)]:[]},ws=function(){console.log("Not implemented yet.")},vs=function(){return[]},bs=function(){console.log("Not implemented yet.")},tn=function(){return n(this,P)==="select"?[...n(this,x)]:[]},en=function(){r(this,o,tn).call(this).forEach(e=>{r(this,o,ut).call(this,e.id)}),n(this,x).clear()},nn=function(){if(n(this,P)!=="select"||n(this,x).size!==1)return null;const e=n(this,x).values().next().value;if(!(e instanceof N))return null;let t=null;for(const i of e.boundFeatures)if(i instanceof A&&i.isEndVertex(e)){if(t)return null;t=i}return t?[e,t]:null},Es=function(){const e=r(this,o,nn).call(this);if(e){const[t,i]=e;r(this,o,Ri).call(this,i,t)}},Ps=function(){return n(this,P)!=="select"?[]:[...n(this,x)].filter(e=>e instanceof N&&e.boundFeatures.length>=2)},Ss=function(){console.log("Not implemented yet.")},xs=function(){return n(this,P)!=="select"?[]:[...n(this,x)].filter(e=>e instanceof N&&!!e.dataObject&&e.boundFeatures.length!==0)},Ls=function(){console.log("Not implemented yet.")},Ts=function(){if(n(this,P)!=="select")return[];const e={},t=[];for(const i of n(this,x))i instanceof N&&i.boundFeatures.length!==0&&i.boundFeatures.forEach(s=>{if(s instanceof A&&!s.isEndVertex(i)){const l=s.vertices.indexOf(i);e[s.id]?t[e[s.id]][1].push(l):(e[s.id]=t.length,t.push([s,[l]]))}});return t},Os=function(){console.log("Not implemented yet.")},Fs=function(){return n(this,P)!=="select"?[]:[...n(this,x)].filter(e=>Et(e)&&e.isNearlyCircular(0))},Cs=function(){console.log("Not implemented yet.")},Is=function(){return n(this,P)!=="select"?[]:[...n(this,x)].filter(e=>Et(e)&&e.isNearlySquare(0))},Ms=function(){console.log("Not implemented yet.")},Vs=function(){if(n(this,P)!=="select")return[];const e=n(this,x).values();if(n(this,x).size===1){const{value:t}=e.next();if(t instanceof N||t instanceof A&&t.vertices.length===2)return[]}else if(n(this,x).size===2){const{value:t}=e.next(),{value:i}=e.next();if(t instanceof N&&i instanceof N)return[]}return[...n(this,x)]},ks=function(){console.log("Not implemented yet.")},zs=function(){console.log("Not implemented yet.")},sn=function(){return n(this,P)!=="select"?[]:[...n(this,x)].filter(Et)},As=function(){r(this,o,sn).call(this).forEach(e=>{e.direction=e.direction===Qe.FORWARD?Qe.BACKWARD:Qe.FORWARD,r(this,o,V).call(this,e)})},Ds=function(){return n(this,P)!=="select"||n(this,x).size===1&&n(this,x).values().next().value instanceof N?[]:[...n(this,x)]},Ns=function(){console.log("Not implemented yet.")},_s=function(){return n(this,P)!=="select"?[]:[...n(this,x)].filter(e=>e instanceof A&&e.isNearlyStraight())},Rs=function(){console.log("Not implemented yet.")},V=function(e){n(this,v).getSource(e.id).setData(e)},y(I,gi,"#00000000"),y(I,yi,"#3bb2d0d0"),y(I,mi,"#ff6d8bd0"),y(I,wi,"#101010"),y(I,vi,"#e0e0e0"),y(I,Lt,15),y(I,vt,["step",["zoom"],!1,n(I,Lt),!0]),y(I,ye,["match",["get","selectionMode"],gt.SELECTED,n(I,yi),gt.HOVERED,n(I,mi),n(I,gi)]);let Ni=I;function Et(a){return a instanceof we}function ro(a){const e=new Er("length","Length"),t=new Pr(e,"mm",!0);e.addUnit(t);const i=new Sr("track_level","Track Level",{surface:"Surface",tunnel:"Underground",bridge:"Bridge"}),s=new ie("geometry","Geometry",null),l=new ie("point","Point",s,"Point"),h=new ie("linestring","Line",s,"LineString"),u=new ie("polygon","Polygon",s,"Polygon"),c=new ie("track_section","Track Section",h);c.addProperty(new Lr(c,"level","Level",!0,!1,i));const p=new ie("conventional_track_section","Railway Track Section",c);p.addProperty(new xr(p,"gauges","Gauge",!1,!1,0,void 0,e));const g=new Ni(a,{units:{length:e},enums:{track_level:i},objects:{geometry:s,point:l,linestring:h,polygon:u,track_section:c,conventional_track_section:p}}),T=new Ii(p);T.setPropertyValue("level","surface"),T.addValueToProperty("gauges",1435),a.on("load",()=>{g.createFeature({dbId:0,type:"Point",lng:1.45,lat:43.6005}),g.createFeature({dbId:1,type:"Point",lng:1.45,lat:43.6}),g.createFeature({dbId:2,type:"Point",lng:1.4505,lat:43.6}),g.createFeature({dbId:3,type:"Point",lng:1.4505,lat:43.6005}),g.createFeature({dbId:4,type:"Point",lng:1.4506,lat:43.601}),g.createFeature({dbId:5,type:"Point",lng:1.4505,lat:43.601}),g.createFeature({dbId:6,type:"Point",lng:1.451,lat:43.6015}),g.createFeature({dbId:7,type:"Point",lng:1.4515,lat:43.6015}),g.createFeature({dbId:8,type:"Point",lng:1.4508,lat:43.601}),g.createFeature({dbId:9,type:"Point",lng:1.451,lat:43.6013}),g.createFeature({dbId:100,type:"LineString",verticesDbIds:[1,2,3,4],dataObject:T}),g.createFeature({dbId:200,type:"Polygon",verticesDbIds:[[3,5,6,7],[4,8,9]]})})}export{ro as default};
